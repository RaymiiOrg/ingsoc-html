
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>Generate hashes of files with rhash for archival storage - Raymii.org</title>
        <!-- <link href="/s/inc/css/custom-first.css" rel="stylesheet" />-->
        <link href="/s/inc/css/marx.css" rel="stylesheet"  />
        <!-- <link href="/s/inc/css/custom.css" rel="stylesheet" title="custom" />-->
        <script src="/s//inc/js/instant.js" type="text/javascript"></script> 
        <script src="/s//inc/js/toc.js" type="text/javascript"></script> 
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
    </head>
    <body>
        
        <a id="top-of-page"></a>
        <main>
        <a class="skip-main" href="#main">Skip to main content</a>
            <header>
                <h1 class="headheader">
                    <a href="https://raymii.org/s/">Raymii.org <img src="/s/inc/img/resistor-50.png"></a>
                </h1>
                <small>
                  Quis custodiet ipsos custodes?<br>
                  <a href="/s/">Home</a> | 
                  <a href="/s/static/About.html">About</a> | 
                  <a href="/s/tags/all.html">All pages</a> | 
                  <a href="https://raymii.org/s/feed.xml">RSS Feed</a> | 
                  <a href="gopher://raymii.org:70">Gopher</a>
                </small>
            </header>
          

    <h2 class='headheader' id='main'>Generate hashes of files with rhash for archival storage</h2><p><small>Published: 11-12-2015 | Author: Remy van Elst | <a href="Generate_hashes_of_files_with_rhash_for_archival_storage.txt" class="link">Text only version of this article</small></a></p><div class='ad'>
                            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <!-- voorartikel -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:728px;height:90px"
                                 data-ad-client="ca-pub-7993642564731324"
                                 data-ad-slot="6172324376"></ins>
                            <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        </div><br><div id="toc"><h3>Table of Contents</h3></div><hr><div id="contents"><p>Recently I had to archive a large amount of files to archival storage. To save
space and reduce the amount of files I decided to create archives with tar. The
files will be stored to tapes and DVD&#39;s, and will be restored in full, so random
access times are not an issue, therefore the tar.gz choice.</p>

<p>I do want to make sure that when the files need to be restored they still are
correct. I first dabbled with some long shell commands to create checksums and
verify them, but then I found the <code>rhash</code> tool in the repositories. It allows
you to create checksums of files and folders, recursively, with all sorts of
checksums, like CRC, MD5, SHA1 and many more. It also makes bulk validation very
simple.</p>

<p>This small article shows you how to create an archive file with the checksums
included and shows you how to validate these checksums later on.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get $100 credit for 60 days). (referral link)</a></p>

<p>The data in question are archived tapes, disk copies, source code and
documentation for the PDP8 mainframe. We also have these for the PDP11 and a few
VAX machines. The archives contain about 5 million files and is about 700 GB in
size. The company decided to phase out the on-line storage and place this data
on tapes and dvd&#39;s, since they&#39;re not accessed more than once or twice a month.</p>

<h3>Creating the hashes</h3>

<p>The first archive contains PDP8 files located in the folder <code>pdp8</code>. This command
creates the <code>MD5SUMS</code> file, which we place in the same folder:</p>

<pre><code>rhash --recursive --md5 --output=pdp8/MD5SUMS pdp8/
</code></pre>

<p>The archive is later on created with a simple <code>tar -czf pdp8.tar.gz pdp8</code>.</p>

<h3>Verifying the hashes</h3>

<p>Extract the archive to a folder and use the following command to verify all
files:</p>

<pre><code>rhash --skip-ok --check pdp8/MD5SUMS 
</code></pre>

<p>If all files match the output looks like this:</p>

<pre><code>--( Verifying pdp8/MD5SUMS )----------------------------------------------------
--------------------------------------------------------------------------------
Everything OK
</code></pre>

<p>If a file does not match the hash, the output will include it:</p>

<pre><code>--( Verifying pdp8/MD5SUMS )----------------------------------------------------
pdp8/pdp8/readme.txt                                ERR
--------------------------------------------------------------------------------
Errors Occurred: Errors:1   Miss:0   Success:3323 Total:3324
</code></pre>

<p>If you leave out the <code>--skip-ok</code> option all files checked will be shown which
might result in long output.</p>

<p>To manually verify one file, first get the checksum:</p>

<pre><code>grep &#39;pdp8/readme.txt&#39; pdp8/MD5SUMS 
53a1aca1631d55de3feece9e1c4d900a  pdp8/pdp8/readme.txt
</code></pre>

<p>Then manually execute the correct checksum command to verify the match:</p>

<pre><code>$ md5sum pdp8/pdp8/readme.txt 
53a1aca1631d55de3feece9e1c4d900a  pdp8/pdp8/readme.txt
</code></pre>
Tags: <a href="../tags/archive.html" class="link">archive</a>, <a href="../tags/bash.html" class="link">bash</a>, <a href="../tags/blog.html" class="link">blog</a>, <a href="../tags/gzip.html" class="link">gzip</a>, <a href="../tags/md5sum.html" class="link">md5sum</a>, <a href="../tags/rhash.html" class="link">rhash</a>, <a href="../tags/tar.html" class="link">tar</a></div><br/><footer><br/>
                <form role="search" action="https://encrypted.google.com/search"
                style="min-width:250px;max-width:300px;">
                    <div class="form-group">
                      <input type="hidden" name="as_sitesearch" value="raymii.org">
                      <input type="hidden" name="as_qdr" value="all">
                      <input type="text" name="as_q" class="form-control" placeholder="Search">
                    </div>
                  </form>
                <br>
                <p>
                <a href="/s/">Home</a> | 
                <a href="/s/static/About.html">About</a> | 
                <a href="/s/tags/all.html">All pages</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                Generated by <a href="/s/software/ingsoc.html">ingsoc</a> | 
            
    </footer>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3704876-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-3704876-6');
    </script>
     
    </body>
    </html>
    