
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>Set up a Collectd client - Raymii.org</title>
        <!-- <link href="/s/inc/css/custom-first.css" rel="stylesheet" />-->
        <link href="/s/inc/css/marx.css" rel="stylesheet"  />
        <!-- <link href="/s/inc/css/custom.css" rel="stylesheet" title="custom" />-->
        <script src="/s//inc/js/instant.js" type="text/javascript"></script> 
        <script src="/s//inc/js/toc.js" type="text/javascript"></script> 
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
    </head>
    <body>
        
        <a id="top-of-page"></a>
        <main>
        <a class="skip-main" href="#main">Skip to main content</a>
            <header>
                <h1 class="headheader">
                    <a href="https://raymii.org/s/">Raymii.org <img src="/s/inc/img/resistor-50.png"></a>
                </h1>
                <small>
                  Quis custodiet ipsos custodes?<br>
                  <a href="/s/">Home</a> | 
                  <a href="/s/static/About.html">About</a> | 
                  <a href="/s/tags/all.html">All pages</a> | 
                  <a href="https://raymii.org/s/feed.xml">RSS Feed</a> | 
                  <a href="gopher://raymii.org:70">Gopher</a>
                </small>
            </header>
          

    <h2 class='headheader' id='main'>Set up a Collectd client</h2><p><small>Published: 09-04-2013 | Author: Remy van Elst | <a href="Collectd_client_setup_tutorial.txt" class="link">Text only version of this article</small></a></p><div class='ad'>
                            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <!-- voorartikel -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:728px;height:90px"
                                 data-ad-client="ca-pub-7993642564731324"
                                 data-ad-slot="6172324376"></ins>
                            <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        </div><br><div id="toc"><h3>Table of Contents</h3></div><hr><div id="contents"><p>This tutorial shows you how to set up a collectd client for use with a collectd
server. What is collectd? collectd gathers statistics about the system it is
running on and stores this information. Those statistics can then be used to
find current performance bottlenecks (i.e. performance analysis) and predict
future system load (i.e. capacity planning). Or if you just want pretty graphs
of your private server and are fed up with some homegrown solution you&#39;re at the
right place, too ;).</p>

<p>You need a collectd server set up to fully use this tutorial, but I also have
written a tutorial to do that.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get $100 credit for 60 days). (referral link)</a></p>

<p><a href="https://raymii.org/s/tutorials/Collectd_server_setup_tutorial_with_web_frontend.html">The collectd server tutorial can be found here</a>.</p>

<p>The collectd client is much easier to set up than the server with web frontend.
It only requires installation and configuring the client.</p>

<h4>Installing Collectd</h4>

<p>First install all the required packages:</p>

<pre><code>sudo apt-get install collectd 
</code></pre>

<h4>Configuring Collectd to talk to our server</h4>

<p>Open your favorite editor and edit the <code>/etc/collectd/collectd.conf</code> file. Read
it, then remove it all and make sure it looks like the below config file:</p>

<pre><code>## /etc/collectd/collectd.conf generated for vps3.sparklingclouds.nl by Ansible
## Config Type: CollectD Client


Hostname $HOSTNAME
FQDNLookup false
Interval 30
ReadThreads 1
LoadPlugin syslog
&lt;Plugin syslog&gt;
        LogLevel info
&lt;/Plugin&gt;

LoadPlugin cpu
LoadPlugin df
LoadPlugin disk
LoadPlugin entropy
LoadPlugin interface
LoadPlugin irq
LoadPlugin load
LoadPlugin memory
LoadPlugin processes
LoadPlugin rrdtool
LoadPlugin swap
LoadPlugin users
LoadPlugin network

## Extra Plugins
LoadPlugin nginx
LoadPlugin iptables
LoadPlugin uptime
LoadPlugin dns
LoadPlugin ping

## CollectD Servers
&lt;Plugin &quot;network&quot;&gt;
        Server &quot;$COLLECTD SERVER IP&quot; &quot;25826&quot;
        Server &quot;$COLLECTD SERVER IP&quot; &quot;25826&quot;
        SecurityLevel None
&lt;/Plugin&gt;


&lt;Plugin rrdtool&gt;
        DataDir &quot;/var/lib/collectd/rrd&quot;
&lt;/Plugin&gt;

Include &quot;/etc/collectd/filters.conf&quot;
Include &quot;/etc/collectd/plugins.conf&quot;
Include &quot;/etc/collectd/thresholds.conf&quot;
</code></pre>

<p>The configuration file is relatively simple. Make sure to replace $VARIABLE$ by
the correct on for your server. You load plugins via <code>&quot;LoadPlugin $name&quot;</code>. The
network part is important, this configures our client to send its data to our
server. Replace $COLLECT SERVER IP with your collectd server IP.</p>

<p>*Make sure the file has a blank newline at the end. If it has not, collectd will <em>fail to start/run correctly</em>.</p>

<h4>Configure collectd plugins</h4>

<p>Now create the following file: <code>/etc/collectd/plugins.conf</code>, it doesn&#39;t exist by
default. This will house the plugin config. Add the following content to it, but
make sure it matches your LoadPlugin settings above. If you don&#39;t have the ping
plugin, you also don&#39;t need the config for it.</p>

<pre><code>## /etc/collectd/plugins.conf 

## Static Plugins (every host has them)
&lt;Plugin swap&gt;
       ReportByDevice false
&lt;/Plugin&gt;


## Dynamic Plugins 
&lt;Plugin nginx&gt;
       URL &quot;http://127.0.0.1/nginx_status&quot;
&lt;/Plugin&gt;

&lt;Plugin ntpd&gt;
       Host &quot;localhost&quot;
       Port 123
       ReverseLookups false
&lt;/Plugin&gt;

&lt;Plugin ping&gt;
       Host &quot;google.com&quot;
&lt;/Plugin&gt;

&lt;Plugin sensors&gt;
       SensorConfigFile &quot;/etc/sensors3.conf&quot;
       Sensor &quot;it8712-isa-0290/temperature-temp1&quot;
       Sensor &quot;it8712-isa-0290/fanspeed-fan3&quot;
       Sensor &quot;it8712-isa-0290/voltage-in8&quot;
       IgnoreSelected false
&lt;/Plugin&gt;

&lt;Plugin write_graphite&gt;
       &lt;Carbon&gt;
               Host &quot;$GRAPHITE_HOST$&quot;
               Port &quot;2003&quot;
               Prefix &quot;collectd&quot;
               Postfix &quot;collectd&quot;
               StoreRates false
               AlwaysAppendDS false
               EscapeCharacter &quot;_&quot;
       &lt;/Carbon&gt;
&lt;/Plugin&gt;
</code></pre>

<p>Collectd server is now set up in &quot;client&quot; mode. To test it we restart the
service:</p>

<pre><code>/etc/init.d/collectd restart
</code></pre>

<p>And then check the <code>/var/lib/collectd/rrd/</code> folder and you should see some files
and folders (rrd libraries). If not then your collectd is setup wrong, see
syslog for more info.</p>

<p>We also should see these files on the collectd server, in the
<code>/var/lib/collectd/rrd</code> folder. If you see them there, you have done it
correctly.</p>

<p>Remember to add the IP to the collectd server firewall.</p>

<p>Now you have a fully working collectd client set up.</p>
Tags: <a href="../tags/collectd.html" class="link">collectd</a>, <a href="../tags/monitoring.html" class="link">monitoring</a>, <a href="../tags/munin.html" class="link">munin</a>, <a href="../tags/rrd.html" class="link">rrd</a>, <a href="../tags/rrdtool.html" class="link">rrdtool</a>, <a href="../tags/statistics.html" class="link">statistics</a>, <a href="../tags/tutorials.html" class="link">tutorials</a></div><br/><footer><br/>
                <form role="search" action="https://encrypted.google.com/search"
                style="min-width:250px;max-width:300px;">
                    <div class="form-group">
                      <input type="hidden" name="as_sitesearch" value="raymii.org">
                      <input type="hidden" name="as_qdr" value="all">
                      <input type="text" name="as_q" class="form-control" placeholder="Search">
                    </div>
                  </form>
                <br>
                <p>
                <a href="/s/">Home</a> | 
                <a href="/s/static/About.html">About</a> | 
                <a href="/s/tags/all.html">All pages</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                Generated by <a href="/s/software/ingsoc.html">ingsoc</a>.
            
    </footer>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3704876-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-3704876-6');
    </script>
     
    </body>
    </html>
    