
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>Windows 7 installer on a KVM Linux VPS (Windows on Digital Ocean) - Raymii.org</title>
        <link href="/s/inc/css/custom-first.css" rel="stylesheet" />
        <!-- <link href="/s/inc/css/light.css" rel="stylesheet"  />
        # <link href="/s/inc/css/custom.css" rel="stylesheet" title="custom" />-->
        <script src="/s//inc/js/instant.js" type="text/javascript"></script> 
        <script src="/s//inc/js/toc.js" type="text/javascript"></script> 
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
    </head>
    <body>
        <a class="skip-main" href="#main">Skip to main content</a>
        <a id="top-of-page"></a>
        <div class="container-fluid ">
            <div class="row">
                <div class="col-md-12">
                    <div class="col-md-3 col-sm-3 max-200">
                        <div class="well well-none"> 
                            <h3 class="headheader"><a href="https://raymii.org/s/">Raymii.org <img src="/s/inc/img/resistor-50.png"></a></h3>
                            <h6 class="headheader">Quis custodiet ipsos custodes?</h6>
                            <h6><a href="https://raymii.org/s/feed.xml">RSS Feed</a> | <a href="gopher://raymii.org:70">Gopher</a></h6>
                        </div>
          

    
    <form role="search" action="https://encrypted.google.com/search">
        <div class="form-group">
          <input type="hidden" name="as_sitesearch" value="raymii.org">
          <input type="hidden" name="as_qdr" value="all">
          <input type="text" name="as_q" class="form-control" placeholder="Search">
        </div>
      </form>
      <div class="menu"><ul class="nav nav-pills nav-stacked"><li><a href="/s/index.html" class="special-menu">Home</a></li><li class='bottom-spacing'><a href="/s/tags/all.html" class="special-menu">All Pages</a></li><li class='hideifsmall'><a href="/s/tags/articles.html" class="link">Articles</a></li>
<li class='hideifsmall'><a href="/s/tags/blog.html" class="link">Blog</a></li>
<li class='hideifsmall'><a href="/s/tags/tutorials.html" class="link">Tutorials</a></li>
<li class='hideifsmall'><a href="/s/tags/ansible.html" class="link">Ansible</a></li><li class='hideifsmall'><a href="/s/tags/openstack.html" class="link">Openstack</a></li><li class='hideifsmall'><a href="/s/tags/bash.html" class="link">Bash</a></li><li class='hideifsmall'><a href="/s/tags/ssl.html" class="link">SSL</a></li><li class='hideifsmall'><a href="/s/tags/monitoring.html" class="link">Monitoring</a></li><li class='hideifsmall'><a href="/s/tags/ubuntu.html" class="link">Ubuntu</a></li><li class='hideifsmall'><a href="/s/tags/openvms.html" class="link">OpenVMS</a></li></ul>            
               <!-- advertisement start -->
                <a href="https://www.digitalocean.com/?refcode=7435ae6b8212"><img src="https://raymii.org/s/inc/img/banner_trans.png"></a><br>
                <a href="http://clients.inceptionhosting.com/aff.php?aff=083">Inception Hosting Affiliate Link</a><br />
                <a href="https://www.digitalocean.com/?refcode=7435ae6b8212">Digital Ocean Affiliate Link, $10 free credit.</a><br />
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- Raymii-2 -->
                <ins class="adsbygoogle"
                     style="display:inline-block;width:200px;height:200px"
                     data-ad-client="ca-pub-7993642564731324"
                     data-ad-slot="9322003332"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <!-- advertisement end -->
                </div>
           </div>  
           <div class="col-md-8 col-sm-8"> 
                <div class="inner">
                <div id="main"></div>

           <h2 class='headheader' id='main'>Windows 7 installer on a KVM Linux VPS (Windows on Digital Ocean)</h2><ul class="breadcrumb"><li><a href="../index.html" class="link">Home</a></li><li><a href="../tags/tutorials.html" class="link">Tutorials</a></li><li><a href="Windows_7_Installer_on_KVM_Linux_VPS_Digital_Ocean.html" class="link">Windows 7 installer on a KVM Linux VPS (Windows on Digital Ocean)</a></li></ul><p><small>Published: 01-07-2018</small> | <small>Author: Remy van Elst | </small><a href="Windows_7_Installer_on_KVM_Linux_VPS_Digital_Ocean.txt" class="link"><small>Text only version of this article</small></a></p><div class='ad'>
                            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <!-- voorartikel -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:728px;height:90px"
                                 data-ad-client="ca-pub-7993642564731324"
                                 data-ad-slot="6172324376"></ins>
                            <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        </div><br><div id="toc"><h3>Table of Contents</h3></div><hr><div id="contents"><p>For fun I wanted to install Windows 7 on a KVM Linux VPS (on <a href="https://www.digitalocean.com/?refcode=7435ae6b8212">Digital Ocean</a>) but it should work for any KVM or XEN-HVM VPS with console access). I was experimenting with Grub2 and ISO booting, since grub2 can natively boot a linux ISO. For Windows this is not possible, the installer needs to be extracted on a FAT32 partition from which you boot. On a normal system I would repartition the disk using a live CD, but on a VPS where an ISO cannot be booted this is troublesome. If I could boot from an ISO I would use that to install Windows, but where&#39;s the fun in that? I had to figure out how to shrink an EXT4 filesystem from a running Ubuntu VPS, which is possible, however very risky, with pivot_root. Next the partiton table can be converted to MBR, the partition can be resized, a FAT32 partiton and filesystem can be created, the Windows Installer files copied onto that, some Grub config and a reboot later, you&#39;re in the Windows 7 Installer. TL;DR, the installer cannot complete due to missing VirtIO drivers, which is a project for another time.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean VPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10 credit). (referral link)</a>  </p>

<p><img src="https://raymii.org/s/inc/img/do_win2.png"></p>

<blockquote>
<p>The finished result, Windows 7 on Digital Ocean</p>
</blockquote>

<h3>Summary and requirements</h3>

<p>Why Windows on a Linux VPS and why Windows 7? Because it&#39;s fun. I learned new stuff about partitioning schemes and how to do harddisk maintenance on a running Linux system. I won&#39;t be using the Windows VPS, in fact I removed it already, but the journey to get there was quite the ride.</p>

<p>Requirements:</p>

<ul>
<li>Windows 7 installer ISO</li>
<li>KVM VPS with console access, at least 2 GB RAM (I used <a href="https://www.digitalocean.com/?refcode=7435ae6b8212">Digital Ocean</a>).</li>
</ul>

<p>The VPS needs 2 GB of ram to create the temporary root filesystem in it. 1 GB is too small for my Ubuntu test system. Windows itself will also not run very well with such a small amount of RAM. </p>

<p>I&#39;ll be using a trial version of Windows 7. I have not tested this with Server 2016 or Windows 10, but the steps should be fairly similar. Remember this is just a fun experiment.</p>

<p>The steps involved are the following:</p>

<ul>
<li>Create a VPS with Ubuntu 16.04 and 2 GB of RAM  (I used <a href="https://www.digitalocean.com/?refcode=7435ae6b8212">Digital Ocean</a>).</li>
<li>Resize the root filesystem while the VPS is running (since we cannot boot a live CD)</li>
<li>Resize the root partition while the VPS is running</li>
<li>Convert the partition table from GPT to MBR</li>
<li>Create a fat32 partition</li>
<li>Copy the Windows 7 ISO installer files on the new partition</li>
<li>Edit Grub2, add the Windows 7 partition</li>
<li>Reboot </li>
<li>???</li>
<li>Profit!</li>
</ul>

<p>Depending on the VPS provider the partition layout might be different. The Digital Ocean VPS has one large root partition as the first partition, no LVM or extended partitions:</p>

<pre><code>root@w:~# lsblk
NAME    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
vda     253:0    0   50G  0 disk
|-vda1  253:1    0 49.9G  0 part /
|-vda14 253:14   0    4M  0 part
`-vda15 253:15   0  106M  0 part /boot/efi
</code></pre>

<h3>Chainloading Windows 7 ISO</h3>

<p>Grub2 <a href="https://help.ubuntu.com/community/Grub2/ISOBoot">can load Linux ISO files directly</a>. None of the pages mentioned anything about Windows, so I tried a few GRUB2 entries to load the Windows 7 ISO from <code>/win7.iso</code>:</p>

<pre><code>menuentry &quot;Win7 1&quot; {
  set isofile=&quot;/win7.iso&quot;
  loopback loop $isofile
  chainloader (loop)
}

  menuentry &quot;Win7 2&quot; {
    insmod ntfs
    insmod ntldr
    set isofile=&quot;/win7.iso&quot;
    loopback loop $isofile
    ntldr (loop)/bootmgr
    boot
}
</code></pre>

<p>None worked, both resulted in a Windows boot which directly errored with <code>Windows BCD boot error 0xc0000225</code>:</p>

<pre><code> Windows failed to start. A recent hardware or software change might be the cause. To fix the problem: 

1. Insert your Windows installation disc and restart your computer. 
2. Choose your language settings, and then click &quot;Next.&quot; 
3. Click &quot;Repair your computer.&quot; 

If you do not have this disc, contact your system administrator or computer manufacturer for assistance.

Status: 0xc0000225
Info: An unexpected error has occurred.
</code></pre>

<p>I found <a href="https://web.archive.org/web/20180701063248/https://volatilesystems.org/booting-multiple-isos-with-grub2-from-one-single-usb-stick.html">one article</a> that suggested Windows needed to be booted from a FAT32 partition where all the files were extracted.</p>

<h3>Online shrink root partition with pivot_root</h3>

<p>An EXT4 partition can be grown without reboots or downtime (using <code>resize2fs</code>). Shrinking is not possible while the partition is mounted. Using <code>pivot_root</code> we create a bare root filesystem in RAM, pivot the linux system in there, unmount the actual disk (since we&#39;re running from RAM) and shrink the partition.</p>

<p>Via <a href="https://web.archive.org/web/20180701063259/https://unix.stackexchange.com/questions/226872/how-to-shrink-root-filesystem-without-booting-a-livecd/227318">this stackoverflow post</a>, a brief summary of steps to do an online resize. This is dangerous and might destroy your system, don&#39;t try it on a production system. It works 99% of the time, but make sure you have working out of band access. </p>

<p>Set a root password first so you can access the console:</p>

<pre><code>passwd
</code></pre>

<p>Output:</p>

<pre><code>Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
</code></pre>

<p>Make it a strong password, you never know who will brute force it.</p>

<p>Install software we need:</p>

<pre><code>apt-get install gdisk cfdisk dosfstools grub-pc
</code></pre>

<p>Unmount all filesystems not in use. Ignore any warnings:</p>

<pre><code>umount -a
</code></pre>

<p>Create the temporary root filesystem in RAM and copy over essential files:</p>

<pre><code>mkdir /tmp/tmproot
mount -t tmpfs none /tmp/tmproot
mkdir /tmp/tmproot/{proc,sys,dev,run,usr,var,tmp,oldroot,root}
cp -ax /{bin,etc,mnt,sbin,lib,lib64} /tmp/tmproot/
cp -ax /usr/{bin,sbin,lib,lib64} /tmp/tmproot/usr/
cp -ax /var/{account,empty,lib,local,lock,nis,opt,preserve,run,spool,tmp,yp} /tmp/tmproot/var/
# don&#39;t forget your SSH key:
cp -axr /root/.ssh /tmp/tmproot/root/
</code></pre>

<p>Pivot into the new RAM root:</p>

<pre><code>mount --make-rprivate / 
pivot_root /tmp/tmproot /tmp/tmproot/oldroot
for i in dev proc sys run; do mount --move /oldroot/$i /$i; done
</code></pre>

<p>Quoting from the article, it explains what were doing:</p>

<pre><code>systemd causes mounts to allow subtree sharing by default (as with mount --make-shared), and this causes pivot_root to fail. Hence, we turn this off globally with mount --make-rprivate /. System and temporary filesystems are moved wholesale into the new root. This is necessary to make it work at all; the sockets for communication with systemd, among other things, live in /run, and so there&#39;s no way to make running processes close it.
</code></pre>

<p>The next step is to close all running processes in the old root. First, restart OpenSSH:</p>

<pre><code>systemctl restart sshd
systemctl status sshd
</code></pre>

<p>Now, don&#39;t close this terminal. First, open a new one and SSH into the VPS. If that works, close the old tab. I forgot to copy over my SSH key in the new root so I had to reboot and start again, since I did close the tab before checking.</p>

<p>Whe&#39;n you&#39;re setup in the new shell, use <code>lsof</code> or <code>fuser</code> on <code>/oldroot/</code> to see which files are open and used:</p>

<pre><code>fuser -vm /oldroot/
</code></pre>

<p>Output:</p>

<pre><code>                     USER        PID ACCESS COMMAND
/oldroot:            root     kernel mount /oldroot
                     root          1 ....m systemd
                     root        624 ....m systemd-journal
                     root        672 ....m lvmetad
                     root        703 f...m systemd-udevd
                     systemd-timesync    881 ....m systemd-timesyn
                     root       1367 ....m iscsid
                     root       1368 ....m iscsid
                     root       1375 ....m systemd-logind
                     root       1379 ....m cron
                     root       1382 ....m accounts-daemon
                     messagebus   1383 ....m dbus-daemon
                     daemon     1393 ....m atd
                     root       1401 ....m acpid
                     root       1407 ....m lxcfs
                     syslog     1415 F...m rsyslogd
                     root       1425 ....m snapd
                     root       1463 ....m polkitd
                     root       1496 ....m mdadm
                     root       1524 ....m agetty
                     root       1529 ....m agetty
                     root       1613 ....m sshd
                     root       1822 ....m systemd
                     root       1824 ....m (sd-pam
                     root       1859 ....m sshd
                     root       1891 ....m bash
</code></pre>

<p>Either <code>kill $PID</code> or <code>systemctl stop $service</code> all the items in that list. Here are the items I had to stop:</p>

<pre><code>systemctl stop rsyslog
systemctl stop snapd
systemctl stop systemd-journald
systemctl stop systemd-logind
systemctl stop systemd-timesyncd
systemctl stop cron
systemctl stop atd
systemctl stop dbus
systemctl stop lxcfs
systemctl stop accounts-daemon
systemctl stop mdadm
systemctl stop iscsid
</code></pre>

<p>The rest of the list was killed via <code>kill $PID</code>:</p>

<pre><code>root@w:~# fuser -vm /oldroot
                     USER        PID ACCESS COMMAND
/oldroot:            root     kernel mount /oldroot
                     root        676 ....m lvmetad
                     root        702 f...m systemd-udevd
                     messagebus   1362 ....m dbus-daemon
                     root       1388 ....m acpid
                     root       1428 ....m mdadm
                     root       1433 ....m polkitd
                     root       1481 ....m agetty
                     root       1483 ....m agetty
                     root       1529 ....m systemd
                     root       1531 ....m (sd-pam

root@w:~# kill 676 702 1362 1388 1428 1433 1481 1483 1529 1531

root@w:~# fuser -vm /oldroot
                     USER        PID ACCESS COMMAND
/oldroot:            root     kernel mount /oldroot
root@w:~#
</code></pre>

<p>Don&#39;t kill PID 1, systemd. Use this systemd command:</p>

<pre><code>systemctl daemon-reexec
</code></pre>

<p>The list should now be empty. No other filesystems should be mounted as well:</p>

<pre><code>root@w:~# mount
sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime)
proc on /proc type proc (rw,nosuid,nodev,noexec,relatime)
udev on /dev type devtmpfs (rw,nosuid,relatime,size=1017012k,nr_inodes=254253,mode=755)
devpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000)
tmpfs on /run type tmpfs (rw,nosuid,noexec,relatime,size=204824k,mode=755)
tmpfs on /sys/fs/cgroup type tmpfs (ro,nosuid,nodev,noexec,mode=755)
cgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/lib/systemd/systemd-cgroups-agent,name=systemd)
none on / type tmpfs (ro,relatime)
</code></pre>

<p>Unmount the device now:</p>

<pre><code>umount /oldroot
</code></pre>

<p>Run a check on the disk:</p>

<pre><code>fsck -Cfy /dev/vda1
</code></pre>

<p>Output:</p>

<pre><code>fsck from util-linux 2.31.1
e2fsck 1.44.1 (24-Mar-2018)
cloudimg-rootfs: recovering journal
Pass 1: Checking inodes, blocks, and sizes
Pass 2: Checking directory structure
Pass 3: Checking directory connectivity
Pass 4: Checking reference counts
Pass 5: Checking group summary information
Free blocks count wrong (11805884, counted=11805839).
Fix? yes

Free inodes count wrong (6390026, counted=6390025).
Fix? yes


cloudimg-rootfs: ***** FILE SYSTEM WAS MODIFIED *****
cloudimg-rootfs: 61175/6451200 files (0.0% non-contiguous), 1272940/13078779 blocks
</code></pre>

<p>Resize the filesystem. In my case the VPS has 40 GB of disk, the FAT32 partition needs to be at least 4 GB to fit the extracted Windows 7 file. I resized the root partition to 35 GB:</p>

<pre><code>resize2fs /dev/vda1 35G
</code></pre>

<p>Output:</p>

<pre><code>resize2fs 1.44.1 (24-Mar-2018)
Resizing the filesystem on /dev/vda1 to 9175040 (4k) blocks.
The filesystem on /dev/vda1 is now 9175040 (4k) blocks long.
</code></pre>

<p>While you&#39;re at it, continue on and modify the partitions.</p>

<h3>Create fat32 partition</h3>

<p>Windows 7 doesn&#39;t seem <a href="https://wiki.archlinux.org/index.php/Dual_boot_with_Windows#Windows_UEFI_vs_BIOS_limitations">to boot from an GPT/EFI disk</a>. I tested my setup in VirtualBox first, where it worked fine. On DigitalOcean, the GPT partition table gave me some trouble, in the end I decided to convert it back to MBR. And of course there is a tool for that already.</p>

<p>While we&#39;re doing all these destructive things to the disk, lets convert the partition table from GPT back to MBR to get Windows 7 to boot. </p>

<p>Use the <code>gdisk</code> tool on <code>/dev/vda</code>:</p>

<pre><code>gdisk /dev/vda
</code></pre>

<p>Output:</p>

<pre><code>Command (? for help): r
</code></pre>

<p>Enter <code>r</code>.</p>

<pre><code>Recovery/transformation command (? for help): g
</code></pre>

<p>Enter  <code>g</code>:</p>

<pre><code>MBR command (? for help): p
</code></pre>

<p>Enter <code>p</code> to print the converted MBR partition layout:</p>

<pre><code>** NOTE: Partition numbers do NOT indicate final primary/logical status,
** unlike in most MBR partitioning tools!

** Extended partitions are not displayed, but will be generated as required.

Disk size is 104857600 sectors (50.0 GiB)
MBR disk identifier: 0x00000000
MBR partitions:

                                                   Can Be   Can Be
Number  Boot  Start Sector   End Sector   Status   Logical  Primary   Code
   1                227328      4612062   primary              Y      0x83
  14                  2048        10239   logical     Y        Y      0xEF
  15                 10240       227327   primary              Y      0x07
</code></pre>

<p>Enter <code>w</code>:</p>

<pre><code>MBR command (? for help): w

Converted 3 partitions. Finalize and exit? (Y/N): y
</code></pre>

<p>Enter <code>Y</code>:</p>

<pre><code>GPT data structures destroyed! You may now partition the disk using fdisk or
other utilities.
</code></pre>

<p>Reinstall GRUB to the partition, otherwise the VPS won&#39;t boot. Mount the disk:</p>

<pre><code>mount /dev/vda1 /mnt
</code></pre>

<p>Install GRUB:</p>

<pre><code>grub-install --root-directory=/mnt /dev/vda
</code></pre>

<p>Output:</p>

<pre><code>Installing for i386-pc platform.
Installation finished. No error reported.
</code></pre>

<p>I use <code>cfdisk</code>, a console UI to manage partitions. Delete the linux partition and re-create it with a smaller size. In my case,  36 GB (to make sure the filesystem fits). Then create a new fat32 partition in the free space. Set the Linux partiton as bootable.</p>

<p><img src="https://raymii.org/s/inc/img/do_part.png"></p>

<p>You can use <code>parted</code> or <code>fdisk</code>, note the start and end numbers of the partition. I prefer <code>cfdisk</code>. </p>

<p>After creating the partitions, reboot the machine. Either via:</p>

<pre><code>echo b &gt; /proc/sysrq-trigger
</code></pre>

<p>or via the VPS provider&#39;s control panel. SSH back in to your VPS afterwards and create the FAT filesystem:</p>

<pre><code>mkfs.vfat /dev/vda2
</code></pre>

<p>Output:</p>

<pre><code>mkfs.fat 3.0.28 (2015-05-16)
</code></pre>

<p>The block device layout now looks like this:</p>

<pre><code>lsblk
</code></pre>

<p>Output:</p>

<pre><code>NAME    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
vda     253:0    0   50G  0 disk
|-vda1  253:1    0   36G  0 part /
|-vda2  253:2    0 13.9G  0 part
|-vda14 253:14   0    4M  0 part
`-vda15 253:15   0  106M  0 part /boot/efi
</code></pre>

<p>Mount the partition:</p>

<pre><code>mount /dev/vda2 /mnt
</code></pre>

<p>The next step is to copy over the Windows ISO.</p>

<h3>Copy Windows installation files to new partition</h3>

<p>Copy over your Windows ISO to your VPS:</p>

<pre><code>$ scp Win7_Pro_SP1_English_x32.iso root@192.0.2.10:
Win7_Pro_SP1_English_x32.iso         [it took a while]  100% 2446MB   3.2MB/s   12:36
</code></pre>

<p>Create a folder to mount it on:</p>

<pre><code>mkdir /w
</code></pre>

<p>Mount the ISO:</p>

<pre><code>mount -o loop /root/Win7_Pro_SP1_English_x32.iso /w
</code></pre>

<p>Output:</p>

<pre><code>mount: /dev/loop0 is write-protected, mounting read-only
</code></pre>

<p>Copy over the files. I use rsync to get a progress indicator:</p>

<pre><code> rsync -avz --progress /w/* /mnt/
</code></pre>

<p>Output:</p>

<pre><code>sending incremental file list
autorun.inf
             43 100%    0.00kB/s    0:00:00 (xfr#1, ir-chk=1042/1043)
bootmgr
        383,786 100%    9.15MB/s    0:00:00 (xfr#2, ir-chk=1041/1043)
setup.exe
        112,400 100%    2.28MB/s    0:00:00 (xfr#3, ir-chk=1040/1043)
boot/
boot/bcd
        262,144 100%    4.90MB/s    0:00:00 (xfr#4, ir-chk=1034/1043)
[...]
upgrade/netfx/netfxupdate.exe
         73,728 100%  155.84kB/s    0:00:00 (xfr#877, to-chk=0/1077)

sent 2,436,207,244 bytes  received 17,955 bytes  17,463,979.92 bytes/sec
total size is 2,582,383,757  speedup is 1.06
</code></pre>

<p>This might take some time. Open another terminal and continue with the Grub editing.</p>

<h3>GRUB2 entry</h3>

<p>Edit the Grub boot loader configuration to boot from your FAT32 partition with the Windows Installer.</p>

<pre><code>vim /boot/grub/grub.cfg
</code></pre>

<p>No need to use the normal way since this disk is going to be wiped. Change the <code>timeout</code> to 300, that way you can use the console of your provider instead of pressing SHIFT to get the grub boot menu. Remove the <code>timeout_style=hidden</code> option if you find it.</p>

<p>Add the following at the bottom of the file:</p>

<pre><code>menuentry &quot;Windows Installer&quot; {
    insmod ntfs
    search --set=root --file /bootmgr
    ntldr /bootmgr
    boot
}
</code></pre>

<p>When the ISO is copied over, reboot and select the Windows option:</p>

<p><img src="https://raymii.org/s/inc/img/do_win.png"></p>

<p>Now you should see the Windows 7 installer starting up:</p>

<p><img src="https://raymii.org/s/inc/img/do_win2.png"></p>

<p>A suprise in the end is that Windows 7 doesn&#39;t have a VirtIO Driver, so the installation is unable to continue on Digital Ocean.</p>

<p>Let&#39;s try it some other time with a newer version of Windows, 10 maybe.</p>
</div><hr>Tags: <a href="../tags/gdisk.html" class="link">gdisk &nbsp;</a><a href="../tags/gpt.html" class="link">gpt &nbsp;</a><a href="../tags/grub.html" class="link">grub &nbsp;</a><a href="../tags/mbr.html" class="link">mbr &nbsp;</a><a href="../tags/microsoft.html" class="link">microsoft &nbsp;</a><a href="../tags/openstack.html" class="link">openstack &nbsp;</a><a href="../tags/partitioning.html" class="link">partitioning &nbsp;</a><a href="../tags/server.html" class="link">server &nbsp;</a><a href="../tags/tutorials.html" class="link">tutorials &nbsp;</a><a href="../tags/ubuntu.html" class="link">ubuntu &nbsp;</a><a href="../tags/vps.html" class="link">vps &nbsp;</a><a href="../tags/windows.html" class="link">windows &nbsp;</a><div class="footer">
                <hr>
                <p>Generated by <a href="/s/software/ingsoc.html">ingsoc</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                <a href="/s/static/About.html">About</a><br />
                </div>
            </div>
        </div>
    </div>  
    </div>
    </div>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3704876-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-3704876-6');
    </script>
     
    </body>
    </html>
    