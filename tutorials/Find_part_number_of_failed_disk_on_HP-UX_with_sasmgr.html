
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>HP-UX 11.31 System information and find out part number of a failed disk with sasmgr - Raymii.org</title>
        <link href="/s/inc/css/custom-first.css" rel="stylesheet" />
        <!-- <link href="/s/inc/css/light.css" rel="stylesheet"  />
        # <link href="/s/inc/css/custom.css" rel="stylesheet" title="custom" />-->
        <script src="/s//inc/js/instant.js" type="text/javascript"></script> 
        <script src="/s//inc/js/toc.js" type="text/javascript"></script> 
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
    </head>
    <body>
        <a class="skip-main" href="#main">Skip to main content</a>
        <a id="top-of-page"></a>
        <div class="container-fluid ">
            <div class="row">
                <div class="col-md-12">
                    <div class="col-md-3 col-sm-3 max-200">
                        <div class="well well-none"> 
                            <h3 class="headheader"><a href="https://raymii.org/s/">Raymii.org <img src="/s/inc/img/resistor-50.png"></a></h3>
                            <h6 class="headheader">Quis custodiet ipsos custodes?</h6>
                            <h6><a href="https://raymii.org/s/feed.xml">RSS Feed</a> | <a href="gopher://raymii.org:70">Gopher</a></h6>
                        </div>
          

    
    <form role="search" action="https://encrypted.google.com/search">
        <div class="form-group">
          <input type="hidden" name="as_sitesearch" value="raymii.org">
          <input type="hidden" name="as_qdr" value="all">
          <input type="text" name="as_q" class="form-control" placeholder="Search">
        </div>
      </form>
      <div class="menu"><ul class="nav nav-pills nav-stacked"><li><a href="/s/index.html" class="special-menu">Home</a></li><li class='bottom-spacing'><a href="/s/tags/all.html" class="special-menu">All Pages</a></li><li class='hideifsmall'><a href="/s/tags/articles.html" class="link">Articles</a></li>
<li class='hideifsmall'><a href="/s/tags/blog.html" class="link">Blog</a></li>
<li class='hideifsmall'><a href="/s/tags/tutorials.html" class="link">Tutorials</a></li>
<li class='hideifsmall'><a href="/s/tags/ansible.html" class="link">Ansible</a></li><li class='hideifsmall'><a href="/s/tags/openstack.html" class="link">Openstack</a></li><li class='hideifsmall'><a href="/s/tags/bash.html" class="link">Bash</a></li><li class='hideifsmall'><a href="/s/tags/ssl.html" class="link">SSL</a></li><li class='hideifsmall'><a href="/s/tags/monitoring.html" class="link">Monitoring</a></li><li class='hideifsmall'><a href="/s/tags/ubuntu.html" class="link">Ubuntu</a></li><li class='hideifsmall'><a href="/s/tags/openvms.html" class="link">OpenVMS</a></li></ul>            
               <!-- advertisement start -->
                <a href="https://www.digitalocean.com/?refcode=7435ae6b8212"><img src="https://raymii.org/s/inc/img/banner_trans.png"></a><br>
                <a href="http://clients.inceptionhosting.com/aff.php?aff=083">Inception Hosting Affiliate Link</a><br />
                <a href="https://www.digitalocean.com/?refcode=7435ae6b8212">Digital Ocean Affiliate Link, $10 free credit.</a><br />
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- Raymii-2 -->
                <ins class="adsbygoogle"
                     style="display:inline-block;width:200px;height:200px"
                     data-ad-client="ca-pub-7993642564731324"
                     data-ad-slot="9322003332"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
                <!-- advertisement end -->
                </div>
           </div>  
           <div class="col-md-8 col-sm-8"> 
                <div class="inner">
                <div id="main"></div>

           <h2 class='headheader' id='main'>HP-UX 11.31 System information and find out part number of a failed disk with sasmgr</h2><ul class="breadcrumb"><li><a href="../index.html" class="link">Home</a></li><li><a href="../tags/tutorials.html" class="link">Tutorials</a></li><li><a href="Find_part_number_of_failed_disk_on_HP-UX_with_sasmgr.html" class="link">HP-UX 11.31 System information and find out part number of a failed disk with sasmgr</a></li></ul><p><small>18-05-2018</small> | <small>Remy van Elst</small> | <a href="Find_part_number_of_failed_disk_on_HP-UX_with_sasmgr.txt" class="link">Text only version of this article</a></p><div class='ad'>
                            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <!-- voorartikel -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:728px;height:90px"
                                 data-ad-client="ca-pub-7993642564731324"
                                 data-ad-slot="6172324376"></ins>
                            <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        </div><br><div id="toc"><h3>Table of Contents</h3></div><hr><div id="contents"><p>On one of my regular scheduled datacenter visits one of the older HP-UX Itanium machines had an orange light on the front. These systems are not (yet) monitored, but still in use so the disk had to be replaced. Not knowing anything about this system or which parts were used, I managed to find the exact part number and device type so we could order a spare. This small guide uses sasmgr to get the data on HP-UX 11.31.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean VPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10 credit). (referral link)</a>  </p>

<h3>Hardware Information on HP-UX</h3>

<p>Since I normally don&#39;t manage these systems and have little experience with HP-UX, I first had to find out some information on the system. Using a few regular Unix tools like <code>netstat</code>, <code>uname</code> and a few HP-UX specific tools like <code>model</code>, <code>machinfo</code> I was able to gather basic hardware information of this machine.</p>

<pre><code>$ TERM=vt100 ssh hpux09 -l root

Last successful login:       Fri May 18 08:18:05 METDST 2018     
Last authentication failure: Fri May 18 08:10:59 METDST 2018     
Last login: Thu Jun 24 09:46:55 2010 from   
(c)Copyright 1983-2006 Hewlett-Packard Development Company, L.P.
(c)Copyright 1979, 1980, 1983, 1985-1993 The Regents of the Univ. of California
(c)Copyright 1980, 1984, 1986 Novell, Inc.
(c)Copyright 1986-2000 Sun Microsystems, Inc.
(c)Copyright 1985, 1986, 1988 Massachusetts Institute of Technology
(c)Copyright 1989-1993  The Open Software Foundation, Inc.
(c)Copyright 1990 Motorola, Inc.
(c)Copyright 1990, 1991, 1992 Cornell University
(c)Copyright 1989-1991 The University of Maryland
(c)Copyright 1988 Carnegie Mellon University
(c)Copyright 1991-2006 Mentat Inc.
(c)Copyright 1996 Morning Star Technologies, Inc.
(c)Copyright 1996 Progressive Systems, Inc.

Confidential computer software. Valid license from HP required for
possession, use or copying.  Consistent with FAR 12.211 and 12.212,
Commercial Computer Software, Computer Software Documentation, and
Technical Data for Commercial Items are licensed to the U.S. Government
under vendor&#39;s standard commercial license.

You have mail.

Value of TERM has been set to &quot;vt100&quot;. 
WARNING:  YOU ARE SUPERUSER !!

hpux09:/root# swlist | grep -i oe
  HPUX11i-BOE                           B.11.31.0809   HP-UX Base Operating Environment 


hpux09:/root# model
ia64 hp server rx3600


hpux09:/root# uname -a
HP-UX hpux09 B.11.31 U ia64 [...] unlimited-user license


hpux09:/root# machinfo
CPU info:
  2 Intel(R) Itanium 2 9100 series processors (1.67 GHz, 18 MB)
          666 MT/s bus, CPU version A1
          4 logical processors (2 per socket)

Firmware info:
   Firmware revision:  04.03
   FP SWA driver revision: 1.18
   IPMI is supported on this system.
   BMC firmware revision: 5.25

Platform info:
   Model:                  &quot;ia64 hp server rx3600&quot;
   Machine ID number:      2e6e7[...]f36
   Machine serial number:  D[...]D

OS info:
   Nodename:  hpux09
   Release:   HP-UX B.11.31
   Version:   U (unlimited-user license)
   Machine:   ia64
   ID Number: [...]
   vmunix _release_version:               
@(#) $Revision: vmunix:    B.11.31_LR FLAVOR=perf 
</code></pre>

<p>This system was installed a long while ago:</p>

<pre><code>hpux09:/root# swlist -l bundle -a date | grep HPUX
  HPUX-FTPServer        Wed Dec 10 16:58:16 MET 2008 
  HPUX-MailServer       Wed Dec 10 16:58:16 MET 2008 
</code></pre>

<p><code>print_manifest</code> is a usefull command for information on the system.</p>

<pre><code>hpux09:/root# print_manifest | grep -i created
    The system was created December 10, 2008, 18:02:06 MET.
    It was created with Ignite-UX revision C.7.7.93.
</code></pre>

<p>This will go into the hardware documentation, since, sadly, that is very incomplete. </p>

<h3>Disk information</h3>

<p>Now to the good part, for which we logged in to this machine. Find the serial number and order a new (probably refurbished) disk.  The system uses LVM with RAID 1 underneath via a SAS card so when the disk is ordered we can just replace it. If it was just LVM we had to do some configuration</p>

<p>This PDF <a href="https://raymii.org/s/inc/downloads/When_Good_Disks_Go_Bad.pdf">When<em>Good</em>Disks<em>Go</em>Bad.pdf</a> is very helpfull in preparing and researching this issue.  When the new disk is here, <a href="http://web.archive.org/web/20180518071714/http://unixpedia.blogspot.nl/2013/11/hpux-sas-physical-disk-replacement_22.html">this page</a> will be helpfull for the replacement.</p>

<p>The first command shows which disk is the failed one plus the raid configuration:</p>

<pre><code>sasmgr get_info -D /dev/sasd0 -q raid
</code></pre>

<p>Output:</p>

<pre><code>Wed May 16 14:54:21 2018

---------- LOGICAL DRIVE 2 ----------

Raid Level                                         : RAID 1              
Volume sas address                                 : 0x3c5c0600358833e   
Device Special File                                : /dev/rdsk/c0t3d0    
Raid State                                         : DEGRADED            
Raid Status Flag                                   : ENABLED             
Raid Size                                          : 139136              
Rebuild Rate                                       : 20.00 %             
Rebuild Progress                                   : 100.00 %            

Participating Physical Drive(s) :

SAS Address         Enc   Bay   Size(MB)      Type            State           

0x500000e01d33a9c2   1     8    140014        PRIMARY         ONLINE         
0x5000c50003aeb459   1     2    140014        SECONDARY       FAILED         

---------- LOGICAL DRIVE 7 ----------

Raid Level                                         : RAID 1              
Volume sas address                                 : 0xacb8d6daa52eb4d   
Device Special File                                : /dev/rdsk/c0t2d0    
Raid State                                         : OPTIMAL             
Raid Status Flag                                   : ENABLED             
Raid Size                                          : 69878               
Rebuild Rate                                       : 0.00 %              
Rebuild Progress                                   : 100.00 %            

Participating Physical Drive(s) :

SAS Address         Enc   Bay   Size(MB)      Type            State           

0x5000039668124686   1     1    286102        SECONDARY       ONLINE         
0x5000c5000b9f5965   1     7    70007         PRIMARY         ONLINE         
</code></pre>

<p>The second command shows the location (controller-wise) and the part number of the disk:</p>

<pre><code>sasmgr get_info -D /dev/sasd0 -q lun=all -q lun_locate 
</code></pre>

<p>Output:</p>

<pre><code>RAID VOL ID is 7 : 
/dev/rdsk/c0t2d0          0/4/1/0.0.0.2.0          

Physical disks in volume are :
        1     1     OFF           HP            EG0300FCSPH        HPD0
        1     7     OFF           HP            DG072BB975         HPDC

RAID VOL ID is 2 : 
/dev/rdsk/c0t3d0          0/4/1/0.0.0.3.0          

Physical disks in volume are :
        1     8     OFF           HP            DG146BABCF         HPD5
        1     2     OFF           HP            DG146ABAB4         HPD5
</code></pre>

<p>In my case disk 1,2 failed:</p>

<pre><code>    0x5000c50003aeb459   1     2    140014        SECONDARY       FAILED         
    [...]
        1     2     OFF           HP            DG146ABAB4         HPD5
</code></pre>

<p>With this part number we can order a new disk. </p>

<p><code>dmesg</code> was also spitting out warning about this disk issue:</p>

<pre><code>SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
LVM: VG 64 0x010000: Lost quorum.
This may block configuration changes and I/Os. In order to reestablish quorum at least 1 of the following PVs (represented by current link) must become available:
&lt;3 0x000006&gt; 
LVM: VG 64 0x010000: PVLink 3 0x000006 Failed! The PV is not accessible.
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x0acb8d6daa52eb4d (dev_t 0x03000004) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x03c5c0600358833e (dev_t 0x03000006) failed with CDB status 0x00000400
class : lunpath, instance 3
lun path (class = lunpath, instance = 3) belonging to LUN (default minor = 0x6) has gone offline.  The lunpath hwpath is 0/4/1/0.0x3c5c0600358833e.0x0

SAS driver at 0/4/1/0 (/dev/sasd0) : RAID volume at SAS address 0x03c5c0600358833e is in a degraded state.
SAS driver at 0/4/1/0 (/dev/sasd0) : RAID volume at SAS address 0x03c5c0600358833e is in a degraded state.
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x0acb8d6daa52eb4d (dev_t 0x03000004) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x0acb8d6daa52eb4d (dev_t 0x03000004) failed with CDB status 0x00000400
SAS driver at 0/4/1/0 (/dev/sasd0) : TM (0x00000002) to SAS address 0x0acb8d6daa52eb4d (dev_t 0x03000004) failed with CDB status 0x00000400
LVM: VG 64 0x010000: Reestablished quorum.
LVM: VG 64 0x010000: PVLink 3 0x000006 Recovered.
LVM: NOTICE: VG 64 0x010000: LV 1: All I/O requests to this LV that were
        waiting indefinitely for an unavailable PV have now completed.
</code></pre>
</div><hr>Tags: <a href="../tags/hp.html" class="link">hp &nbsp;</a><a href="../tags/hp-ux.html" class="link">hp-ux &nbsp;</a><a href="../tags/itanium.html" class="link">itanium &nbsp;</a><a href="../tags/lvm.html" class="link">lvm &nbsp;</a><a href="../tags/raid.html" class="link">raid &nbsp;</a><a href="../tags/sas.html" class="link">sas &nbsp;</a><a href="../tags/sasmgr.html" class="link">sasmgr &nbsp;</a><a href="../tags/tutorials.html" class="link">tutorials &nbsp;</a><a href="../tags/unix.html" class="link">unix &nbsp;</a><div class="footer">
                <hr>
                <p>Generated by <a href="/s/software/ingsoc.html">ingsoc</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                <a href="/s/static/About.html">About</a><br />
                </div>
            </div>
        </div>
    </div>  
    </div>
    </div>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3704876-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-3704876-6');
    </script>
     
    </body>
    </html>
    