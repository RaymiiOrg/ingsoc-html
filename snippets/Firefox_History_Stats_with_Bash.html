
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>Firefox History stats with Bash - Raymii.org</title>
        <!-- <link href="/s/inc/css/custom-first.css" rel="stylesheet" />-->
        <link href="/s/inc/css/marx.css" rel="stylesheet"  />
        <!-- <link href="/s/inc/css/custom.css" rel="stylesheet" title="custom" />-->
        <script src="/s//inc/js/instant.js" type="text/javascript"></script> 
        <script src="/s//inc/js/toc.js" type="text/javascript"></script> 
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
    </head>
    <body>
        
        <a id="top-of-page"></a>
        <main>
        <a class="skip-main" href="#main">Skip to main content</a>
            <header>
                <h1 class="headheader">
                    <a href="https://raymii.org/s/">Raymii.org <img src="/s/inc/img/resistor-50.png"></a>
                </h1>
                <small>
                  Quis custodiet ipsos custodes?<br>
                  <a href="/s/">Home</a> | 
                  <a href="/s/static/About.html">About</a> | 
                  <a href="/s/tags/all.html">All pages</a> | 
                  <a href="https://raymii.org/s/feed.xml">RSS Feed</a> | 
                  <a href="gopher://raymii.org:70">Gopher</a>
                </small>
            </header>
          

    <h2 class='headheader' id='main'>Firefox History stats with Bash</h2><p><small>Published: 25-09-2016 | Author: Remy van Elst | <a href="Firefox_History_Stats_with_Bash.txt" class="link">Text only version of this article</small></a></p><div class='ad'>
                            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <!-- voorartikel -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:728px;height:90px"
                                 data-ad-client="ca-pub-7993642564731324"
                                 data-ad-slot="6172324376"></ins>
                            <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        </div><br><div id="toc"><h3>Table of Contents</h3></div><hr><div id="contents"><p>This is a small script to gather some statistics from your Firefox history.
First we use sqlite3 to parse the Firefox history database and get the last
three months, then we remove all the IP addresses and port numbers and finally
we sort and count it.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get $100 credit for 60 days). (referral link)</a></p>

<pre><code>#!/bin/bash
if [[ ! -d ${HOME}/.www ]]; then
  mkdir ${HOME}/.www/
fi

cp &quot;$(find &quot;${HOME}/.mozilla/firefox/&quot; -name &quot;places.sqlite&quot; | head -n 1)&quot; &quot;${HOME}/.www/places.sqlite&quot;
sqlite3 &quot;${HOME}/.www/places.sqlite&quot; &quot;SELECT url FROM moz_places, moz_historyvisits \
                       WHERE moz_places.id = moz_historyvisits.place_id \
                             and visit_date &gt; strftime(&#39;%s&#39;,&#39;now&#39;,&#39;-3 month&#39;)*1000000 ORDER by \
                       visit_date;&quot;  &gt; &quot;${HOME}/.www/urls-unsorted&quot;
sort -u &quot;${HOME}/.www/urls-unsorted&quot; &gt; &quot;${HOME}/.www/urls&quot;

awk -F/ &#39;{print $3}&#39; &quot;${HOME}/.www/urls&quot; | grep -v -E -e &#39;[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}&#39; -e &#39;:.*&#39; -e &#39;^$&#39; | sed -e &#39;s/www\.//g&#39; |sort | uniq -c | sort -n 
</code></pre>

<p>Example output:</p>

<pre><code>    383 lowendtalk.com
    534 reddit.com
    569 google.com
    574 github.com
    792 encrypted.google.com
    973 i.imgur.com
   1458 next.duckduckgo.com
   3009 duckduckgo.com
   6459 wiki.int
  12934 management.int
</code></pre>

<p>If you just want HTTPS domains, or just HTTP you can use awk to make that
happen:</p>

<pre><code>awk -F/ &#39;$1 == &quot;https:&quot; {print $3}&#39; &quot;${HOME}/.www/urls&quot; | grep -v -E -e &#39;[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}&#39; | sort | uniq -c | sort
</code></pre>
Tags: <a href="../tags/bash.html" class="link">bash</a>, <a href="../tags/firefox.html" class="link">firefox</a>, <a href="../tags/history.html" class="link">history</a>, <a href="../tags/snippets.html" class="link">snippets</a>, <a href="../tags/sqlite.html" class="link">sqlite</a>, <a href="../tags/ubuntu.html" class="link">ubuntu</a></div><br/><footer><br/>
                <form role="search" action="https://encrypted.google.com/search"
                style="min-width:250px;max-width:300px;">
                    <div class="form-group">
                      <input type="hidden" name="as_sitesearch" value="raymii.org">
                      <input type="hidden" name="as_qdr" value="all">
                      <input type="text" name="as_q" class="form-control" placeholder="Search">
                    </div>
                  </form>
                <br>
                <p><small>
                <a href="/s/">Home</a> | 
                <a href="/s/static/About.html">About</a> | 
                <a href="/s/tags/all.html">All pages</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                Generated by <a href="/s/software/ingsoc.html">ingsoc</a>.</small></p>
            
    </footer>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3704876-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-3704876-6');
    </script>
     
    </body>
    </html>
    