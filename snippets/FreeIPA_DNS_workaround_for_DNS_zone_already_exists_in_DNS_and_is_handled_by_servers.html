
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>FreeIPA DNS workaround for DNS zone [...]. already exists in DNS and is handled by server(s): - Raymii.org</title>
        <!-- <link href="/s/inc/css/custom-first.css" rel="stylesheet" />-->
        <link href="/s/inc/css/marx.css" rel="stylesheet"  />
        <!-- <link href="/s/inc/css/custom.css" rel="stylesheet" title="custom" />-->
        <script src="/s//inc/js/instant.js" type="text/javascript"></script> 
        <script src="/s//inc/js/toc.js" type="text/javascript"></script> 
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
    </head>
    <body>
        
        <a id="top-of-page"></a>
        <main>
        <a class="skip-main" href="#main">Skip to main content</a>
            <header>
                <h1 class="headheader">
                    <a href="https://raymii.org/s/">Raymii.org <img src="/s/inc/img/resistor-50.png"></a>
                </h1>
                <small>
                  Quis custodiet ipsos custodes?<br>
                  <a href="/s/">Home</a> | 
                  <a href="/s/static/About.html">About</a> | 
                  <a href="/s/tags/all.html">All pages</a> | 
                  <a href="https://raymii.org/s/feed.xml">RSS Feed</a> | 
                  <a href="gopher://raymii.org:70">Gopher</a>
                </small>
            </header>
          

    <h2 class='headheader' id='main'>FreeIPA DNS workaround for DNS zone [...]. already exists in DNS and is handled by server(s):</h2><p><small>Published: 10-04-2018 | Author: Remy van Elst | <a href="FreeIPA_DNS_workaround_for_DNS_zone_already_exists_in_DNS_and_is_handled_by_servers.txt" class="link">Text only version of this article</small></a></p><div class='ad'>
                            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <!-- voorartikel -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:728px;height:90px"
                                 data-ad-client="ca-pub-7993642564731324"
                                 data-ad-slot="6172324376"></ins>
                            <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        </div><br><div id="toc"><h3>Table of Contents</h3></div><hr><div id="contents"><p>Recently I ran into an issue with FreeIPA when trying to add an existing DNS
zone. The zone already exists on the internet so, logically, FreeIPA wouldn&#39;t
allow me to hijack this domain locally. My usecase is special, so I wanted to
forcefully add this zone as a forward zone.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get $100 credit for 60 days). (referral link)</a></p>

<p>In the web UI of FreeIPA when trying to add this existing zone, the following
error appears:</p>

<pre><code>DNS zone example.org. already exists in DNS and is handled by server(s): ns1.kpn.com, ns2.kpn.com
</code></pre>

<p>This is a logical error since hijacking a domain like this is a bad idea,
features like DNSSEC will bite you.</p>

<p>My setup however was different. In this setup, domain <code>sub.example.org</code> was
delegated to this environment, but via some tunneling constructions VPSes in
this environment would be able to connect internally to the <code>example.org</code>
domain. So, I want the FreeIPA system that is also the DNS resolver, to forward
queries for <code>example.org</code> to the local internal nameserver in the <code>example.org</code>
domain, and not resolving them externally.</p>

<p>FreeIPA wouldn&#39;t let me do that via the GUI. Which is IMHO the good option,
since you are doing something that normally will break stuff. Using the
commandline we can skip this overlap check with the <code>--skip-overlap-check</code> flag:</p>

<pre><code> ipa dnsforwardzone-add  --skip-overlap-check example.org --forwarder=192.0.2.10 --forwarder=198.51.100.10 --forward-policy=only
Server will check DNS forwarder(s).
This may take some time, please wait ...
  Zone name: example.org.
  Active zone: TRUE
  Zone forwarders: 192.0.2.10, 198.51.100.10
  Forward policy: only
</code></pre>

<p>If you do not want to add a forward zone, you can also use this flag to add a
regular zone:</p>

<pre><code>ipa dnszone-add --skip-overlap-check example.org --forwarder=192.0.2.10 --forwarder=198.51.100.10 --forward-policy=only
</code></pre>
Tags: <a href="../tags/bind.html" class="link">bind</a>, <a href="../tags/dns.html" class="link">dns</a>, <a href="../tags/freeipa.html" class="link">freeipa</a>, <a href="../tags/network.html" class="link">network</a>, <a href="../tags/snippets.html" class="link">snippets</a>, <a href="../tags/traceroute.html" class="link">traceroute</a></div><br/><footer><br/>
                <form role="search" action="https://encrypted.google.com/search"
                style="min-width:250px;max-width:300px;">
                    <div class="form-group">
                      <input type="hidden" name="as_sitesearch" value="raymii.org">
                      <input type="hidden" name="as_qdr" value="all">
                      <input type="text" name="as_q" class="form-control" placeholder="Search">
                    </div>
                  </form>
                <br>
                <p>
                <a href="/s/">Home</a> | 
                <a href="/s/static/About.html">About</a> | 
                <a href="/s/tags/all.html">All pages</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                Generated by <a href="/s/software/ingsoc.html">ingsoc</a> | 
            
    </footer>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3704876-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-3704876-6');
    </script>
     
    </body>
    </html>
    