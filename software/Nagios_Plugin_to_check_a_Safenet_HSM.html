
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>Nagios plugin to check Safenet HSM - Raymii.org</title>
        <!-- <link href="/s/inc/css/custom-first.css" rel="stylesheet" />-->
        <link href="/s/inc/css/marx.css" rel="stylesheet"  />
        <!-- <link href="/s/inc/css/custom.css" rel="stylesheet" title="custom" />-->
        <script src="/s//inc/js/instant.js" type="text/javascript"></script> 
        <script src="/s//inc/js/toc.js" type="text/javascript"></script> 
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/>
        <link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" />
    </head>
    <body>
        
        <a id="top-of-page"></a>
        <main>
        <a class="skip-main" href="#main">Skip to main content</a>
            <header>
                <h1 class="headheader">
                    <a href="https://raymii.org/s/">Raymii.org <img src="/s/inc/img/resistor-50.png"></a>
                </h1>
                <small>
                  Quis custodiet ipsos custodes?<br>
                  <a href="/s/">Home</a> | 
                  <a href="/s/tags/all.html">All pages</a> | 
                  <a href="https://raymii.org/s/feed.xml">RSS Feed</a> | 
                  <a href="gopher://raymii.org:70">Gopher</a>
                </small>
            </header>
          

    <h2 class='headheader' id='main'>Nagios plugin to check Safenet HSM</h2><p><small>Published: 03-05-2013 | Author: Remy van Elst | <a href="Nagios_Plugin_to_check_a_Safenet_HSM.txt" class="link">Text only version of this article</small></a></p><div class='ad'>
                            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                            <!-- voorartikel -->
                            <ins class="adsbygoogle"
                                 style="display:inline-block;width:728px;height:90px"
                                 data-ad-client="ca-pub-7993642564731324"
                                 data-ad-slot="6172324376"></ins>
                            <script>
                            (adsbygoogle = window.adsbygoogle || []).push({});
                            </script>
                        </div><br><div id="toc"><h3>Table of Contents</h3></div><hr><div id="contents"><p>This is a Nagios plugin to monitor a Safenet Protectserver HSM using the Safenet
tools. It can also gather information about the device, like firmware and
functional module information.</p>

<p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital Ocean
VPS. With this link you&#39;ll get $100 credit for 60 days). (referral link)</a></p>

<h3>Usage</h3>

<pre><code>usage: ./hsm.sh options

This script checks various safenet HSM things and outputs nagios style results.

OPTIONS:
   -h      Show this message
   -t      Check type: &quot;battery&quot;, &quot;RAM&quot;, &quot;datetime&quot;, &quot;eventlog&quot;, &quot;initialized&quot;, &quot;hsminfo&quot;, &quot;fminfo&quot;
   -n      HSM name for $ET_HSM_NETCLIENT_SERVERLIST.
   -b      ctcheck binary (default: /opt/PTK/bin/ctcheck)

CHECKS:
   battery          Show HSM Battery status, GOOD (ok) or LOW (crit)
   ram              HSM RAM, (ok) if &lt;75% used, (warn) &gt;75% &lt;85% used, (crit) if &gt;85% used.
   datetime         Local HSM date/time, (crit) if different from host time, host should use ntp in same timezone.
   eventlog         (ok) if eventlog not full, (crit) if eventlog full.
   initialized      (ok) if initialized, (crit) if not. Documentation states that a FALSE could mean a tampered device.
   hsminfo          always (ok), returns general HSM info, model, version, firmware and such.
   fminfo           always (ok), returns Functional Module information.
</code></pre>

<h3>Examples</h3>

<pre><code>user@host ~$ ./hsm.sh -n hsm-038 -t ram
OK: RAM Usage OK: 41% used, ( 10192256 total). HSM: hsm-038.
user@host ~$ ./hsm.sh -n hsm-038 -t datetime
OK: HSM: hsm-038 time is the same as local time: 15/04/2013 12:48.
user@host ~$ ./hsm.sh -n hsm-038 -t eventlog
OK: HSM: hsm-038 Event Log Count: 11
user@host ~$ ./hsm.sh -n hsm-038 -t initialized
OK: HSM: hsm-038 is initialized. All is well.
user@host ~$ ./hsm.sh -n hsm-038 -t hsminfo
OK: HSM: hsm-038; Serial Number:[...]; Model: [...]; Device Revision: F; Firmware Revision: [...]; Manufacturing Date: [...]; Device Batch: [...]; PTKC Revision: [...]; Slot Count: [...] Security Mode: [...]; Transport Mode:[...]; Event Log Count: 88.
user@host ~$ ./hsm.sh -n hsm-038 -t battery
OK: Battery status is good for HSM: hsm-038
</code></pre>

<h3>Download</h3>

<p><a href="https://github.com/RaymiiOrg/nagios">Either via Github</a> or <a href="https://raymii.org/s/inc/software/check_hsm.sh">from this website</a></p>
Tags: <a href="../tags/hsm.html" class="link">hsm</a>, <a href="../tags/monitoring.html" class="link">monitoring</a>, <a href="../tags/nagios.html" class="link">nagios</a>, <a href="../tags/safenet.html" class="link">safenet</a>, <a href="../tags/software.html" class="link">software</a></div><br/><footer><br/>
                <form role="search" action="https://encrypted.google.com/search"
                style="min-width:250px;max-width:300px;">
                    <div class="form-group">
                      <input type="hidden" name="as_sitesearch" value="raymii.org">
                      <input type="hidden" name="as_qdr" value="all">
                      <input type="text" name="as_q" class="form-control" placeholder="Search">
                    </div>
                  </form>
                <br>
                <p>Generated by <a href="/s/software/ingsoc.html">ingsoc</a> | 
                <a href="/s/software/Sparkling_Network.html">Cluster Status</a> | 
                <a href="/s/static/About.html">About</a><br />
            
    </footer>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3704876-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-3704876-6');
    </script>
     
    </body>
    </html>
    