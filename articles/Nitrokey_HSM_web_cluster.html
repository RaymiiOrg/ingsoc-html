    <!DOCTYPE html><html lang="en"><head><title>Nitrokey HSM/SmartCard-HSM and Raspberry Pi web cluster - Raymii.org</title><style>*,::before,::after{background-repeat:no-repeat;-webkit-box-sizing:border-box;box-sizing:border-box}::before,::after{text-decoration:inherit;vertical-align:inherit}html{cursor:default;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.15;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-break:break-word}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{height:0;overflow:visible}main{display:block}nav ol,nav ul{list-style:none}pre{font-family:Menlo,Consolas,Roboto Mono,Ubuntu Monospace,Noto Mono,Oxygen Mono,Liberation Mono,monospace;font-size:1em}a{background-color:transparent}abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:Menlo,Consolas,Roboto Mono,Ubuntu Monospace,Noto Mono,Oxygen Mono,Liberation Mono,monospace;font-size:1em}small{font-size:80%}::-moz-selection{background-color:#b3d4fc;color:#000;text-shadow:none}::selection{background-color:#b3d4fc;color:#000;text-shadow:none}audio,canvas,iframe,img,svg,video{vertical-align:middle}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not([fill]){fill:currentColor}svg:not(:root){overflow:hidden}table{border-collapse:collapse}button,input,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit}button,input,select{margin:0}button{overflow:visible;text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}fieldset{padding:.35em .75em .625em}input{overflow:visible}legend{color:inherit;display:table;max-width:100%;white-space:normal}progress{display:inline-block;vertical-align:baseline}select{text-transform:none}textarea{margin:0;overflow:auto;resize:vertical}[type="checkbox"],[type="radio"]{padding:0}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:1px dotted ButtonText}details{display:block}dialog{background-color:white;border:solid;color:black;display:block;height:-moz-fit-content;height:-webkit-fit-content;height:fit-content;left:0;margin:auto;padding:1em;position:absolute;right:0;width:-moz-fit-content;width:-webkit-fit-content;width:fit-content}dialog:not([open]){display:none}summary{display:list-item}canvas{display:inline-block}template{display:none}a,area,button,input,label,select,summary,textarea,[tabindex]{-ms-touch-action:manipulation;touch-action:manipulation}[hidden]{display:none}[aria-busy="true"]{cursor:progress}[aria-controls]{cursor:pointer}[aria-disabled="true"],[disabled]{cursor:not-allowed}[aria-hidden="false"][hidden]:not(:focus){clip:rect(0,0,0,0);display:inherit;position:absolute}main,header,footer,article,section,aside,details,summary{margin:0 auto;margin-bottom:16px;width:100%}main{display:block;margin:0 auto;max-width:1000px;padding:0 16px 16px}footer{border-top:1px solid rgba(0,0,0,.12);padding:16px 0;text-align:left}footer p{margin-bottom:0}hr{border:0;border-top:1px solid rgba(0,0,0,.12);display:block;margin-top:16px;margin-bottom:16px;width:100%;-webkit-box-sizing:content-box;box-sizing:content-box;height:0;overflow:visible}img{height:auto;max-width:100%;vertical-align:baseline}@media screen and (max-width:400px){article,section,aside{clear:both;display:block;max-width:100%}img{margin-right:16px}}embed,iframe,video{border:0}body{color:rgba(0,0,0,.8);font-family:"Raleway",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:16px;line-height:1.5}p{margin:0;margin-bottom:16px}h1,h2,h3,h4,h5,h6{color:inherit;font-family:inherit;line-height:1.2;font-weight:500}h1{font-size:40px;margin:20px 0 16px}h2{font-size:32px;margin:20px 0 16px}h3{font-size:28px;margin:16px 0 4px}h4{font-size:24px;margin:16px 0 4px}h5{font-size:20px;margin:16px 0 4px}h6{font-size:16px;margin:16px 0 4px}small{color:rgba(0,0,0,.54);vertical-align:bottom}pre{background:#f7f7f9;color:rgba(0,0,0,.8);display:block;font-family:Menlo,Monaco,Consolas,"Courier New",monospace;font-size:16px;margin:16px 0;padding:16px;white-space:pre-wrap;overflow-wrap:break-word}code{color:rgba(0,0,0,.8);font-family:Menlo,Monaco,Consolas,"Courier New",monospace;font-size:16px;line-height:inherit;margin:0;padding:0;vertical-align:baseline;word-break:break-all;word-wrap:break-word}a{color:#75cc00;text-decoration:none;background-color:transparent}a:hover,a:focus{color:#0062cc;text-decoration:underline}dl{margin-bottom:16px}dd{margin-left:40px}ul,ol{margin-bottom:8px;padding-left:40px;vertical-align:baseline}blockquote{border-left:2px solid rgba(0,0,0,.8);font-family:Georgia,Times,"Times New Roman",serif;font-style:italic;margin:16px 0;padding-left:16px}figcaption{font-family:Georgia,Times,"Times New Roman",serif}u{text-decoration:underline}s{text-decoration:line-through}sup{font-size:14px;vertical-align:super}sub{font-size:14px;vertical-align:sub}mark{background:#ffeb3b}input[type="text"],input[type="password"],input[type="email"],input[type="url"],input[type="date"],input[type="month"],input[type="time"],input[type="datetime"],input[type="datetime-local"],input[type="week"],input[type="number"],input[type="search"],input[type="tel"],select,textarea{background:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,.12);border-radius:4px;color:rgba(0,0,0,.8);display:block;width:100%;padding:8px 16px;line-height:1.5;-webkit-transition:border-color .15s ease-in-out,-webkit-box-shadow .15s ease-in-out;transition:border-color .15s ease-in-out,-webkit-box-shadow .15s ease-in-out;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out,-webkit-box-shadow .15s ease-in-out;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}input[type="color"]{background:#fff;border:1px solid rgba(0,0,0,.12);border-radius:4px;display:inline-block;vertical-align:middle}input:not([type]){-webkit-appearance:none;background:#fff;background-clip:padding-box;border:1px solid rgba(0,0,0,.12);border-radius:4px;color:rgba(0,0,0,.8);display:block;width:100%;padding:8px 16px;line-height:1.5;-webkit-transition:border-color .15s ease-in-out,-webkit-box-shadow .15s ease-in-out;transition:border-color .15s ease-in-out,-webkit-box-shadow .15s ease-in-out;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out,-webkit-box-shadow .15s ease-in-out;text-align:left}input[type="text"]:focus,input[type="password"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="time"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,input[type="week"]:focus,input[type="number"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="color"]:focus,select:focus,textarea:focus{background-color:#fff;border-color:#80bdff;outline:0;-webkit-box-shadow:0 0 0 .2rem rgba(0,123,255,.25);box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}input:not([type]):focus{background-color:#fff;border-color:#80bdff;outline:0;-webkit-box-shadow:0 0 0 .2rem rgba(0,123,255,.25);box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}input[type="file"]:focus,input[type="radio"]:focus,input[type="checkbox"]:focus{outline:1px thin rgba(0,0,0,.12)}input[type="text"][disabled],input[type="password"][disabled],input[type="email"][disabled],input[type="url"][disabled],input[type="date"][disabled],input[type="month"][disabled],input[type="time"][disabled],input[type="datetime"][disabled],input[type="datetime-local"][disabled],input[type="week"][disabled],input[type="number"][disabled],input[type="search"][disabled],input[type="tel"][disabled],input[type="color"][disabled],select[disabled],textarea[disabled]{background-color:rgba(0,0,0,.12);color:rgba(0,0,0,.54);cursor:not-allowed;opacity:1}input:not([type])[disabled]{background-color:rgba(0,0,0,.12);color:rgba(0,0,0,.54);cursor:not-allowed;opacity:1}input[readonly],select[readonly],textarea[readonly]{border-color:rgba(0,0,0,.12);color:rgba(0,0,0,.54)}input:focus:invalid,textarea:focus:invalid,select:focus:invalid{border-color:#ea1c0d;color:#f44336}input[type="file"]:focus:invalid:focus,input[type="radio"]:focus:invalid:focus,input[type="checkbox"]:focus:invalid:focus{outline-color:#f44336}select{border:1px solid rgba(0,0,0,.12);vertical-align:sub}select:not([size]):not([multiple]){height:-webkit-calc(2.25rem + 2px);height:calc(2.25rem + 2px)}select[multiple]{height:auto}label{display:inline-block;line-height:2}fieldset{border:0;margin:0;padding:8px 0}legend{border-bottom:1px solid rgba(0,0,0,.12);color:rgba(0,0,0,.8);display:block;margin-bottom:8px;padding:8px 0;width:100%}textarea{overflow:auto;resize:vertical}input[type=checkbox],input[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;display:inline}input[type=submit],input[type=reset],input[type=button],button{background-color:#75cc00;border:#75cc00;border-radius:4px;color:#fff;padding:8px 16px;display:inline-block;font-weight:400;text-align:center;white-space:nowrap;vertical-align:middle;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:1px solid transparent;font-size:1rem;line-height:1.5;-webkit-transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,-webkit-box-shadow .15s ease-in-out;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,-webkit-box-shadow .15s ease-in-out;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out,-webkit-box-shadow .15s ease-in-out}input[type=submit]::-moz-focus-inner,input[type=reset]::-moz-focus-inner,input[type=button]::-moz-focus-inner,button::-moz-focus-inner{padding:0}input[type=submit]:hover,input[type=reset]:hover,input[type=button]:hover,button:hover{background-color:#0069d9;border-color:#0062cc;color:#fff}input[type=submit]:not(:disabled):active,input[type=reset]:not(:disabled):active,input[type=button]:not(:disabled):active,button:not(:disabled):active{background-color:#0062cc;border-color:#005cbf;color:#fff}input[type=submit]:focus,input[type=reset]:focus,input[type=button]:focus,button:focus{outline:0;-webkit-box-shadow:0 0 0 .2rem rgba(0,123,255,.5);box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}input[type=submit]:disabled,input[type=reset]:disabled,input[type=button]:disabled,button:disabled{opacity:.65;cursor:not-allowed;background-color:#75cc00;border-color:#75cc00;color:#fff}table{border-top:1px solid rgba(0,0,0,.12);margin-bottom:16px}caption{padding:8px 0}thead th{border:0;border-bottom:2px solid rgba(0,0,0,.12);text-align:left}tr{margin-bottom:8px}th,td{border-bottom:1px solid rgba(0,0,0,.12);padding:16px;white-space:nowrap;vertical-align:inherit}tfoot tr{text-align:left}tfoot td{color:rgba(0,0,0,.54);font-size:8px;font-style:italic;padding:16px 4px}a.skip-main{left:-999px;position:absolute;top:auto;width:1px;height:1px;overflow:hidden;z-index:-999}a.skip-main:focus,a.skip-main:active{color:#fff;background-color:#000;left:auto;top:auto;width:30%;height:auto;overflow:auto;margin:10px 35%;padding:5px;border-radius:15px;border:4px solid yellow;text-align:center;font-size:1.2em;z-index:999}@font-face{font-family:'Raleway';font-display: swap;font-style:normal;font-weight:400;src:url(/s/inc/css/raleway.eot);src:local('Raleway'),local('Raleway'),url(/s/inc/css/raleway.ttf)}.headheader{font-family:"Raleway"!important}.headheader a{color:#000;text-decoration:none}.headheader a:hover{color:#000;text-decoration:none!important}</style><script>window.onload=function(){var a="",b=0;document.getElementById("contents").innerHTML=document.getElementById("contents").innerHTML.replace(/<h([\d])>([^<]+)<\/h([\d])>/gi,function(c,d,e,f){if(d!=f)return c;d>b?a+=Array(d-b+1).join(""):d<b&&(a+=Array(b-d+1).join("")),b=parseInt(d);var g=e.replace(/ /g,"_");return a+="<a href=\"#"+g+"\">"+e+"</a><br/>","<h"+d+"><a name=\""+g+"\">"+e+"</a></h"+f+">"}),b&&(a+=Array(b+1).join("")),document.getElementById("toc").innerHTML+=a};</script><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0"><link type="application/opensearchdescription+xml" rel="search" href="/s/inc/opensearch.xml"/><link rel="alternate" type="application/rss+xml" title="RSS Feed for Raymii.org" href="https://raymii.org/s/feed.xml" /></head><body><a id="top-of-page"></a><main><a class="skip-main" href="#main">Skip to main content</a><header><h1 class="headheader"><a href="https://raymii.org/s/">Raymii.org                         <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAKCAYAAAD2Fg1xAAABgElEQVQ4jb3VP0iVYRTH8c9waXBokog7OYhTXChuF3GIi4hoiJA4REQIOTgGtoWTg6ODs0SYComIXCJEMhpKtD9guUU0ujRFS0PQ8DzC24v3Pq+3S9/pnMOP8/7Ocx6el/OziRN0JXTD+I2xhK4WdeNteGmbu8IgC3jQQlfCZ0zgINHzJabwoQP+ClHGV1zGJXwRDJ/FDJZi3MBQE10dL2K8gZFOGE3REDZyyjLunKG7KAzZHfMaXjXp+QbXYlzBfrvmSuhBNaHrxQU8zdQW8RhrOe0snuB7zA/jd6p4n9HV8QMfY/4JPzGAt7meFfS18LdXEk7uemIQuJ/Lj6PZQezFWhm3cTWnXcAj3MrU5oWh5WpzGM3UurGNZy28HSa8J7mB3Uy+4u/rl+UdrsT4Jraa6F6jP5M3MP0PHguzL9zzqmC2GRNYjXF2qDzDwgbgHp53wGMhJrEunGQ9oT3CQ+GFasWBsLVvwiv5XygJz/JOAe208POrJHST+CVspBB/AFY9Q3+QJqLxAAAAAElFTkSuQmCC" alt="Logo (IEC resistor symbol)"><img src="https://cdn.raymii.org/logo.png" alt="logo"></a></h1><small>                  Quis custodiet ipsos custodes?<br><a href="/s/">Home</a> |                   <a href="/s/static/About.html">About</a> |                   <a href="/s/tags/all.html">All pages</a> |                   <a href="https://raymii.org/s/feed.xml">RSS Feed</a> |                   <a href="gopher://raymii.org:70">Gopher</a></small></header><h2 class='headheader' id='main'>Nitrokey HSM/SmartCard-HSM and Raspberry Pi web cluster</h2><p><small>Published: 01-08-2016 | Author: Remy van Elst | <a href="Nitrokey_HSM_web_cluster.txt">Text only version of this article</a></small></p><div class='ad'><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle"                                 style="display:inline-block;width:728px;height:90px"                                 data-ad-client="ca-pub-7993642564731324"                                 data-ad-slot="6172324376"></ins><script>                            (adsbygoogle = window.adsbygoogle || []).push({});                            </script></div><br><div id="toc"><h3>Table of Contents</h3></div><hr><div id="contents"><p><img src="https://raymii.org/s/inc/img/hsmcluster.jpg" alt=""></p><blockquote><p>The 3-Pi HSM cluster to be used for the cluster articles</p></blockquote><p>This article sets up a Nitrokey HSM/SmartCard-HSM web cluster and has a lot ofbenchmarks. This specific HSM is not a fast HSM since it&#39;s very inexpensive andtargeted at secure key storage, not performance. But, what if you do want moreperformance? Then you scale horizontally, just add some more HSM&#39;s and aloadbalancer in front.</p><p>You want to put your private key material inside an HSM because it cannot bestolen that way. A HSM does not allow key material to be exported, so nobody cansecretly copy the keys and use them without your knowledge. If the HSM istampered with, it will also wipe itself, so brute forcing it will not work.</p><p>The cluster consists of Raspberry Pi&#39;s and Nitrokey HSM&#39;s and SmartCard-HSM&#39;s,softwarewise we use Apache, <code>mod_nss</code> and haproxy.</p><p>This is the first time I had an actual use case for Raspberry Pi&#39;s in a cluster,and I really enjoyed doing it. I might even, in the future, add some more Pi&#39;son top and do some more benchmarks. But I already spent about two weeks workingon this single article so three was just fine for now.</p><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital OceanVPS. With this link you&#39;ll get $100 credit for 60 days). (referral link)</a></p><p>Do note that two devices were sponsored for this article.</p><p>We benchmark a small HTML file and a Wordpress site using:</p><ul><li>a 8192 bit RSA certificate without using the HSM&#39;s</li><li>a 4096 bit RSA certificate without using the HSM&#39;s</li><li>a 2048 bit RSA certificate without using the HSM&#39;s</li><li>a 1024 bit RSA certificate without using the HSM&#39;s</li><li><p>a prime256v1 EC certificate without using the HSM&#39;s</p></li><li><p>a 2048 bit RSA certificate in the HSM</p></li><li><p>a 1024 bit RSA certificate in the HSM</p></li><li><p>a prime256v1 EC certificate in the HSM. </p></li></ul><p>We do these benchmarks with the <code>OpenSC</code> module and with the <code>sc-hsm-embedded</code>module to see if that makes any difference.</p><p>The full raw results are provided at the end of the article. I first talk a bitmore about the HSM&#39;s, the cluster setup and the issues I had with the RaspberryPi&#39;s. Then we set up the three HSM devices and the load balancer. Finally,before the raw results, we have nice charts and interpretation of the charts,plus an unexpected conclusion.</p><h3>Introduction</h3><p><img src="https://raymii.org/s/inc/img/sc-hsm-nitrokey.jpg" alt=""></p><blockquote><p>The Nitrokey HSM and the SmartCard-HSM</p></blockquote><p>The <a href="http://nitrokey.com">Nitrokey HSM</a> is an open hardware and open software device. It is a USBversion of the <a href="http://www.smartcard-hsm.com/">SmartCard-HSM</a>. Both the <a href="http://www.smartcard-hsm.com/opensource.html">SmartCard-HSM</a> as the <a href="https://github.com/nitrokey">NitrokeyHSM</a> have sources available and are fully supported by the <a href="https://github.com/OpenSC/OpenSC/wiki/SmartCardHSM">OpenSC</a>project.</p><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital OceanVPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10credit). (referral link)</a></p><p><img src="https://raymii.org/s/inc/img/sc-hsm.jpg" alt=""></p><blockquote><p>The SmartCard-HSM</p></blockquote><p>If you are new to the NitroKey HSM/SmartCard HSM, please also <a href="https://raymii.org/s/articles/Get_Started_With_The_Nitrokey_HSM.html">read my gettingstarted</a> article. It explains what the HSM is, how to set it up and how touse it with OpenSSH for example.</p><p>I have <a href="https://raymii.org/s/tags/nitrokey.html">multiple articles</a> on this nice device, so make sure to read theothers as well.</p><h3>How many HSM&#39;s?</h3><p><img src="https://raymii.org/s/inc/img/3hsm.jpg" alt=""></p><blockquote><p>Three Nitrokey&#39;s in their bags</p></blockquote><p>This guide uses three Nitrokey HSM devices. I&#39;ve generated three keypairs on oneof the HSM&#39;s, one RSA 1024, one RSA 2048 and one EC key, just as we did in <a href="https://raymii.org/s/articles/Use_the_Nitrokey_HSM_or_SmartCard-HSM_with_sc-hsm-embedded_mod_nss_and_Apache_read_only_module.html">the<code>mod_nss</code> tutorial</a>. Please consult that article first, since the keygeneration and certificate loading part is not included in this guide.</p><p>I&#39;ll refer to the HSM where the DKEK was initialized and the keys were generatedas HSM 1. The other two HSM&#39;s are referred two as HSM 2 and HSM 3.</p><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital OceanVPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10credit). (referral link)</a></p><p>This guide uses three Raspberry Pi 3 comuters, wired network with Raspbiantesting (2016-07-29) and with the three HSM devices plugged in.</p><p>At first I tried to use the HSM&#39;s on the host computer, with different virtualhosts. That works when using the OpenSC module, but not with the sc-hsm-embeddedmodule. <a href="https://github.com/CardContact/sc-hsm-embedded/issues/12">That module doesn&#39;t support token labels</a>, yet, so there was no wayto distinguish between them. I did try to setup three different NSS databaseswhere the HSM&#39;s were only enabled by ID but that still resulted in the three ofthem being used. To make all tests equal, I went for a second option.</p><p>That second option was using three different virtual machines on the same PCwith VirtualBox and USB passthrough in VirtualBox:</p><p><img src="https://raymii.org/s/inc/img/hsmshare.png" alt=""></p><p>That however gave all kinds of errors with the HSM&#39;s in use. At first it workedjust fine with <code>mod_nss</code> but whenever I tried to do more than 5 concurrentactions on the HSM the connection was lost and it became unresponsive, to thepart that even <code>sc-hsm-tool</code> did not recognize the HSM and a VM reboot wasrequired. So that wasn&#39;t a viable solution either. On to the third option itwas.</p><h3>Cluster setup</h3><p>THe final solution was using three different computers. Since I wanted to keepit simple, fair and not too expensive I decided to buy three Raspberry Pi 3&#39;s. Ibought them from the dutch store <a href="https://www.kiwi-electronics.nl/">Kiwi-Electronics</a> including two <a href="https://www.kiwi-electronics.nl/raspberry-pi-stackable-case-kit-black?search=stack">stackablecases</a>. (These links are not affiliate links, just had a great experiencethere. Their order confirmation lists the ordering IP, and in my case it was myIPv6 address. Yay +1 for them!). The case comes from <a href="https://www.modmypi.com/blog/multi-pi-assembly-guide">ModMyPi</a> and I mighteven just recreate it in Inkscape and use my lasercutter in the future forexpansion.</p><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital OceanVPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10credit). (referral link)</a></p><p>The Raspberry Pi 3 Model B&#39;s have the following specs:</p><ul><li>1.2GHz 64-bit quad-core ARMv8 CPU</li><li>1 GB LPDDR2 RAM 900 MHz</li><li>100 Mbit NIC</li><li>4x USB 2.0</li></ul><p>They also have Wifi and bluetooth but I did not use that. All the benchmarkswere done over the wired network. The OS is <a href="https://raymii.org/s/blog/Raspberry_Pi_Raspbian_Unattended_Upgrade_Jessie_to_Testing.html">Raspbian Testing</a>. Since thecurrent normal Raspbian ships <code>OpenSC</code> 0.14 which doesn&#39;t support the SmartCard-HSM/Nitrokey HSM an upgrade was required. The current testing ships with OpenSC0.16, which does work with the SmartCard-HSM/Nitrokey HSM.</p><p>To combine the three machines into one single service I used <code>haproxy</code> in TCPmode. <code>haproxy</code> is a very fast and scalable HTTP(s)/TCP load balancer. I&#39;ve usedit in production for many years now and have been happy with it ever since.</p><p>I did also try <code>nginx</code> since that also <a href="https://www.nginx.com/resources/admin-guide/tcp-load-balancing/">supports TCP and UDP loadbalancing</a>. The results were very comparable, so I think the load balanceris not the limiting factor here.</p><p>The software stack used on Raspbian Testing is the following:</p><ul><li>Apache 2.4.23 (Raspbian)</li><li>mpm_event</li><li>PHP 7.0.8-5</li><li>MySQL 5.6.30-1 (Raspbian)</li><li>php-fpm / fcgi</li><li>Wordpress 4.5.3</li><li><code>mod_nss</code> 1.0.12-2</li></ul><p>I&#39;m using <code>mpm_event</code> and <code>php-fpm</code> instead of <code>mpm_prefork</code> and <code>mod-php</code>because of issues with the initialization of the HSM by all the workers. See<a href="https://www.redhat.com/archives/mod_nss-list/2016-July/msg00000.html">the mailinglist thread here</a> for more information. Otherwise all kinds oferrors like <code>SSL Library Error: -8152 The key does not support the requestedoperation</code> and <code>SSL Library Error: -8023 Unknown</code> and <code>SSL Library Error: -12216Attempt to write encrypted data to underlying socket failed</code> and <code>SSL inputfilter read failed.</code> occur.</p><p>To install all the software and configure everything except for the HSM keygeneration I&#39;ve created a set of Ansible playbooks. Because nobody wants tohandcraft three special snowflakes. I&#39;ve burned through 7 MicroSD cards beforegetting to a working setup. I also tried to use Arch and Ubuntu 16.04 but thoseimages all had their own instabillites, so I just settled on Raspbian testing.</p><p><img src="https://raymii.org/s/inc/img/ansible_nss.png" alt=""></p><p>I might put the playbooks on here someday, but now they are intertwined to muchwith my personal playbooks to make sense without it.</p><p>How do you keep the HSM&#39;s apart? Well, I&#39;ve used a very high-tech solution forthat, namely using three different coloured key-cords:</p><p><img src="https://raymii.org/s/inc/img/hsmkeycord.jpg" alt=""></p><p>Stickers might also be an option.</p><h3>Initialize the new HSM&#39;s</h3><p>Plug in HSM 2.</p><p>If you execute <code>sc-hsm-tool</code> it will notify you that the new HSM has never beeninitialized:</p><pre><code>$ sc-hsm-tool </code></pre><p>Output:</p><pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 02 00Version              : 2.0SmartCard-HSM has never been initialized. Please use --initialize to set SO-PIN and user PIN.</code></pre><p>HSM 1 was initialized with one DKEK share. We initialize the new HSMs and importthe DKEK share, to make sure the key backups work. We also give it a differentlabel.</p><pre><code>sc-hsm-tool --initialize --so-pin 3537363231383830 --pin 648219 --dkek-shares 1 --label &#39;hsm2&#39;</code></pre><p>Output:</p><pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 02 00</code></pre><p>Import the DKEK share:</p><pre><code>sc-hsm-tool --import-dkek-share dkek-share-1.pbe</code></pre><p>Output:</p><pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 02 00Enter password to decrypt DKEK share : 123456789Deciphering DKEK share, please wait...DKEK share importedDKEK shares          : 1DKEK key check value : 0FB85F69F6EBF256</code></pre><p>Repeat the above process for HSM 3 and any more HSM&#39;s you have. Make sure togive them descriptive labels. Unplug the other HSM&#39;s when initializing one, tomake sure you don&#39;t overwrite the wrong one.</p><p>The new HSM&#39;s are now initialized with the same DKEK as the old HSM. The nextstep is to securely backup the existing keys from the old HSM and import theminto the new HSMs. This works because we&#39;re using the same DKEK.</p><h3>Backup and restore the keys</h3><p>Plug in HSM 1.</p><p>Wrap (export) the keys on HSM 1:</p><pre><code>sc-hsm-tool --wrap-key wrap-key-1.bin --key-reference 1 --pin 648219sc-hsm-tool --wrap-key wrap-key-2.bin --key-reference 2 --pin 648219sc-hsm-tool --wrap-key wrap-key-3.bin --key-reference 3 --pin 648219</code></pre><p>Output:</p><pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 00 00</code></pre><p>Plug in HSM 2.</p><p>Unwrap (import) the keys on the HSM 2:</p><pre><code>sc-hsm-tool --unwrap-key wrap-key-1.bin --key-reference 1 --pin 648219sc-hsm-tool --unwrap-key wrap-key-2.bin --key-reference 2 --pin 648219sc-hsm-tool --unwrap-key wrap-key-3.bin --key-reference 3 --pin 648219</code></pre><p>Output:</p><pre><code>Using reader with a card: Nitrokey Nitrokey HSM (010000000000000000000000) 00 00Wrapped key contains:  Key blob  Private Key Description (PRKD)  CertificateKey successfully imported</code></pre><p>Repeat this for HSM 3.</p><p>With all the keys imported and three HSM&#39;s plugged in, <code>pkcs11-tool</code> gives somenice output:</p><pre><code>pkcs11-tool --module opensc-pkcs11.so --login --pin 648219 --list-slotsAvailable slots:Slot 0 (0x0): Nitrokey Nitrokey HSM (010000000000000000000000) 00 00  token label        : hsm3 (UserPIN)  token manufacturer : www.CardContact.de  token model        : PKCS#15 emulated  token flags        : rng, login required, PIN initialized, token initialized  hardware version   : 24.13  firmware version   : 2.0  serial num         : DENK0100485Slot 1 (0x4): Lenovo Integrated Smart Card Reader 01 00  (empty)Slot 2 (0x8): Nitrokey Nitrokey HSM (010000000000000000000000) 02 00  token label        : hsm1 (UserPIN)  token manufacturer : www.CardContact.de  token model        : PKCS#15 emulated  token flags        : rng, login required, PIN initialized, token initialized  hardware version   : 24.13  firmware version   : 2.0  serial num         : DENK0100186Slot 3 (0xc): Nitrokey Nitrokey HSM (010000000000000000000000) 03 00  token label        : hsm2 (UserPIN)  token manufacturer : www.CardContact.de  token model        : PKCS#15 emulated  token flags        : rng, login required, PIN initialized, token initialized  hardware version   : 24.13  firmware version   : 2.0  serial num         : DENK0100436</code></pre><p>If you want to do operations on a specific device you can add the <code>--slot</code>parameter to the <code>pkcs11-tool</code> command. For example, to generate a key just onHSM 2 (slot 3/c):</p><pre><code>$ pkcs11-tool --module opensc-pkcs11.so --login --pin 648219 --keypairgen --key-type EC:prime256v1 --slot c --id 10 --label &quot;ect&quot;</code></pre><h3>Raspberry Pi setup</h3><p>The Raspberry Pi&#39;s are on the network via a wired connection. They run <a href="https://raymii.org/s/blog/Raspberry_Pi_Raspbian_Unattended_Upgrade_Jessie_to_Testing.html">RaspbianTesting</a> because of the OpenSC version.</p><p>The following steps should be done on the three Pi&#39;s:</p><ul><li>HSM driver installation (OpenSC)</li><li>Apache and <code>mod_nss</code> installation</li><li>NSS Certificate database setup</li><li>Apache and <code>mod_nss</code> configuration</li></ul><p>Please consult the <a href="https://raymii.org/s/articles/Nitrokey_HSM_in_Apache_with_mod_nss.html">mod_nss opensc</a> guide or the <a href="https://raymii.org/s/articles/Use_the_Nitrokey_HSM_or_SmartCard-HSM_with_sc-hsm-embedded_mod_nss_and_Apache_read_only_module.html">mod_nss with sc-hsm-embedded</a> guide for the specific setup and repeat that on all the RaspberryPi&#39;s. I&#39;m not going to cover the setup here any further.</p><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital OceanVPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10credit). (referral link)</a></p><h3>Apache setup</h3><p>Remember to not use <code>mod_php</code> and <code>mpm_prefork</code>. I used <code>mpm_event</code> and <code>php-fpm</code> (PHP 7).</p><p>Here is the <code>mpm_event</code> configuration:</p><pre><code>    StartServers             20    MinSpareThreads          250    MaxSpareThreads          500    ThreadLimit              64    ThreadsPerChild          25    MaxRequestWorkers        500    MaxConnectionsPerChild   150</code></pre><p>I couldn&#39;t get <code>fastcgi</code> to run, but it seems Apache uses its own module now(<code>proxy_fcgi</code>).</p><p>Make sure to restart Apache after configuring.</p><p>Repeat this step on all the VM&#39;s.</p><h3>Configure haproxy</h3><p>Make sure you have haproxy installed:</p><pre><code>apt-get install haproxy</code></pre><p>I&#39;m using version 1.6.6. I&#39;ve got a few <a href="https://raymii.org/s/tags/haproxy.html">other articles</a> on HAproxy ifyou&#39;re interested. HAproxy does not run on the Raspberry Pi&#39;s, but on my localhost (A Lenovo Thinkpad x240, i5, 8GB RAM, Arch linux), so don&#39;t install this inthe VM&#39;s.</p><p>HAproxy can do many things in http mode, but we&#39;re not using that. We will beusing <code>tcp</code> mode with a <code>roundrobin</code> configuration. This means that whenrequests come in, haproxy proxy&#39;s the TCP connection to the backends. Requestone goes to hsm1, request two to hsm 2, request 3 to hsm 3 and request 4 goes tohsm 1. This way the server can handle more concurrent requests. This is my basichaproxy configuration file, <code>/etc/haproxy/haproxy.cfg</code>:</p><pre><code>global    maxconn     20000    log         hsmcluster.nl local0    user        haproxy    chroot      /usr/share/haproxy    pidfile     /run/haproxy.pid    daemonfrontend hsm    bind *:443    mode tcp    default_backend hsm    timeout client 1mbackend hsm    mode tcp    balance roundrobin    timeout connect 10s    timeout server 1m    server hsm01 10.0.0.106:8443    server hsm02 10.0.0.107:8443    server hsm03 10.0.0.108:8443</code></pre><p>My VM&#39;s have the <code>10.0.0.106</code>, <code>107</code> and <code>108</code> addresses.</p><p>Restart <code>haproxy</code> after changing the config.</p><p>In my <code>hosts</code> file I&#39;ve setup the domain <a href="https://hsmcluster.nl">hsmcluster.nl</a> on localhost.</p><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital OceanVPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10credit). (referral link)</a></p><h3>NGINX in TCP mode</h3><p>If you prefer to use NGINX then you can use this example configuration:</p><pre><code>worker_processes  1;events {    worker_connections  1024;}stream {    server {      listen 443;      proxy_pass hsm_backend;    }    upstream hsm_backend {      server 10.0.0.106:443;      server 10.0.0.100:443;      server 10.0.0.105:443;    }}</code></pre><h3>Charts and result interpretation</h3><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital OceanVPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10credit). (referral link)</a></p><p>Here below I&#39;ll look into the various aspects and results of the benchmark. Thelast section of the article gives you the raw numbers/benchmark siege results toplay around yourself. This is the more readable part if you&#39;re not into numbercrunching.</p><h4>Siege result parsing</h4><p>Siege gives you different types of metrics. We do the same benchmark over andover so we&#39;re interesed in some, not all. The time for example is 30 secondseverywhere. Here is, <a href="https://www.joedog.org/siege-manual/#a08">from the manual</a>, the explanation of the metrics weuse.</p><ul><li>Transactions is the number of server hits.</li><li>Response time is the average time it took to respond to each simulated user&#39;s requests.</li><li>Transaction rate is the average number of transactions the server was able to handle per second, in a nutshell: transactions divided by elapsed time.</li><li>Concurrency is average number of simultaneous connections, a number which rises as server performance decreases.</li></ul><h4><code>mod_ssl</code>. no HSM</h4><p><img src="https://raymii.org/s/inc/img/hsm/no-hsm-mod_ssl.png" alt=""></p><p>As we can see here the 1024 bit RSA key is the fastest. 2048 bit RSA is just atidbit slower, but still acceptable. 4096 bit RSA keys take a huge dump down intransactions and the response time and concurrency go up.</p><p>8192 bit RSA keys slow down to a grinding halt, huge response time, lowtransaction rate. It might be super secure, but super slow as well.</p><p>Same goes for the EC prime256v1 keys. Most of the time EC keys are faster, butit seems the Pi&#39;s have trouble with it, just as much as with the 8192 bit RSAkeys.</p><h4>1024 bit RSA key</h4><p><img src="https://raymii.org/s/inc/img/hsm/1024-bit-rsa.png" alt=""></p><p>We can see that the HSM is around 8 times slower than using regular <code>mod_ssl</code>.But, we knew that already. Adding a HSM to the loadbalancer doubles theperformance, and adding two HSM&#39;s to the loadbalancer triples it, as we wouldexpect. So, going down that route, if we have 8 HSM&#39;s, it would be just as fastas regular <code>mod_ssl</code>.</p><p>Something that caught my eye was that with one HSM the <code>OpenSC</code> module wasfaster. (Remember, best of three for the tests, every test is done three times,best result is kept.). When using multiple HSM&#39;s we see a small gain intransactions when using <code>sc-hsm-embedded</code>. I&#39;m not quite sure why that is, butit&#39;s something that steps out.</p><p>But, as we all know, using an 1024 bit RSA key is considered insecure. So don&#39;tdo that in production.</p><p>Here is the same data with only the HSM&#39;s so that you can see the differencesbetter between OpenSC and sc-embedded-hsm:</p><p><img src="https://raymii.org/s/inc/img/hsm/1024-bit-rsa-hsm.png" alt=""></p><h4>2048 bit RSA key</h4><p><img src="https://raymii.org/s/inc/img/hsm/2048-bit-rsa.png" alt=""></p><p>2048 bit keys are way harder for the HSM, but not at all for regular <code>mod_ssl</code>.In this case it is about 26 times slower when using a HSM, comparing to no HSM.Here we see again that the transaction rate is doubled and trippled when addingHSM&#39;s to the cluster. The same thing here with sc-hsm-embedded, when used with 1HSM it&#39;s slower, but when scaling up it becomes a little bit faster.</p><p>Here is the same data with only the HSM&#39;s so that you can see the differencesbetter between OpenSC and sc-embedded-hsm:</p><p><img src="https://raymii.org/s/inc/img/hsm/2048-bit-rsa-hsm.png" alt=""></p><h4>prime256v1 EC key</h4><p><img src="https://raymii.org/s/inc/img/hsm/prime256v1-ec.png" alt=""></p><p>I think the Pi&#39;s have trouble with the prime256v1 EC key. When using just oneHSM, the performance almost doubles. When we use three HSM&#39;s the performance isalmost as good as with the 1024 bit RSA key. In all cases OpenSC was slower thanthe sc-hsm-embedded module.</p><p>What suprises me the most is that EC algorithms are supposed to be faster thenRSA. It might be that non-Pi hardware has the AES-NI extension or something.</p><h4>Different keysizes, 1 HSM</h4><p><img src="https://raymii.org/s/inc/img/hsm/different-keys-hsms.png" alt=""></p><p>This is an interesting one. We see that the EC prime256v1 key is almost as fastas the RSA 1024 bit key. Also, OpenSC is slower here with the EC keypair. <a href="https://security.stackexchange.com/a/78624">Mostbrowsers</a> support prime256v1, also named NIST curve P-256. There however aresome concerns <a href="https://www.nsa.gov/ia/programs/suiteb_cryptography/">since the NSA is involved</a>. Keep that in mind. Still, thefastest modern algorithm in this HSM.</p><h4>Burst mode</h4><p>The burst mode benchmark is different than the above ones. The above tests takea random amount of seconds between 1 and 5 and delay each connection thatamount. This gives you a more realistic test than when your just hammering everysecond. Hammering every second is a performance measure, because you can thenmeasure how many connections your server could handle at peak times.</p><p>This test fires of 60 connections for half a minute and doesnt take any timebetween them. Just bang bang bang. The results differ from the 20 connectiontest because the HSM then has some time to recover, so to say, betweenconnections. The more HSM&#39;s you add to the cluster, the more time each one willhave to recover, the better your tests will be.</p><p>The burst benchmark doesn&#39;t hit the wordpress site but the small text file.</p><p><img src="https://raymii.org/s/inc/img/hsm/60-1024.png" alt=""></p><p>The chart above is for an 1024 bit RSA key. We see that without the HSM it isthe fastest, topping a whopping 7000+ transactions. Here is the picture withoutthat, so make it more clear what the differences with HSM are.</p><p><img src="https://raymii.org/s/inc/img/hsm/60-1024-hsm.png" alt=""></p><p>Same results as above, adding more HSM&#39;s gives better performance. Note that sc-hsm-embedded is only faster in the 3 HSM test.</p><p>This is the score for 2048 bit keys, including the test without the HSM:</p><p><img src="https://raymii.org/s/inc/img/hsm/60-2048.png" alt=""></p><p>Same as above, more HSM makes stuff faster, without the HSM we see an enourmusspeed bump. Here&#39;s the graph without the last part:</p><p><img src="https://raymii.org/s/inc/img/hsm/60-2048-hsm.png" alt=""></p><p>Strange, sc-embedded-hsm is only faster here with 2 HSM&#39;s and OpenSC wassignificantly lower with 2 HSM&#39;s. I did rone this specific test again a fewtimes but all gave comparable results.</p><p>Last but not least, the prime256v1 EC key. This is the only time where the HSMis faster, I suspect because it provides offloading (the Pi lacks cryptohardware?).</p><p><img src="https://raymii.org/s/inc/img/hsm/60-prime256v1.png" alt=""></p><p>Using the HSM here almost doubles the performance, using three HSM&#39;s you getalmost 6 times the performance of no HSM. I did not expect this at all, but I dofind it awesome.</p><h3>Conclusion</h3><ul><li>Using this HSM with RSA is significantly slower than not using this HSM</li><li>Using this HSM with EC is significantly faster than not using this HSM</li><li>8192 bit RSA is slower than trying to nail hammer <a href="https://raymii.org/s/inc/img/pudding.jpg">jelly pudding</a> to a wall</li><li>Adding one HSM to the cluster doubles the performance</li><li>Adding two HSM&#39;s to the cluster tripples the performance</li><li>You need about 10 HSM&#39;s (for RSA 1024) or 26 HSM&#39;s (for RSA 2048) to have the same performance without a HSM</li><li>You need about two Pi&#39;s without a HSM to have the same performance as with one HSM with prime256v1 EC.</li></ul><p>In general this was what I expected, except for the EC part. As said at thestart of the article, the Nitrokey/SmartCard-HSM is not built for this use case,although it works absolutely fine, just a bit slower.</p><p>I&#39;ve browsed the wordpress site, did some searching, installed some plugins(slider, contact form etc) and created a few blog posts, which all works justfine. I have 500/500 mbit fiber at home so I do notice the delay, but theperformance is comparable to a location with regular DSL and a 8/2 mbit speed.Which means I&#39;m spoiled and most people will not notice the difference.</p><p><a href="https://www.digitalocean.com/?refcode=7435ae6b8212">If you like this article, consider sponsoring me by trying out a Digital OceanVPS. With this link you&#39;ll get a $5 VPS for 2 months free (as in, you get $10credit). (referral link)</a></p><p>Below I&#39;ll talk more about something I tried first for the graphs and then giveyou more information on the benchmarks and the raw results.</p><h3>Chart creation</h3><p>I first tried to use GNUPlot to create charts based on the <code>siege</code> log file withthe following gnuplot file:</p><pre><code>set term png truecolor size 600,600set output &quot;data.png&quot;set title &quot;2048 bit RSA key&quot;set boxwidth 1 relativeset gridset key outside;set key top;set style fill transparent solid 0.5 border rgb&quot;black&quot;set style data histogramset style fill solid borderset style histogram clusteredplot for [COL=2:4] &#39;siegedata&#39; using COL:xticlabels(1) title columnheader </code></pre><p>The siege log is transformed to a usable datafile using the following commands:</p><pre><code>awk -F, &#39;{print $2&quot;:&quot;$5&quot;:&quot;$8}&#39; siege.log  | awk &#39;{print NR-1&quot;-PI:&quot;,$0}&#39; | sed &#39;s/\s\+//g&#39;  | sed -e &#39;1s/^...../Number /&#39; -e &#39;s/:/ /g&#39;</code></pre><p>This is the result of the command:</p><pre><code>Number Trans RespTime Concurrent1-HSM 9 0.83 0.252-HSM 23 1.06 0.823-HSM 124 2.34 9.68</code></pre><p>The original siege log was:</p><pre><code>      Date &amp; Time,  Trans,  Elap Time,  Data Trans,  Resp Time,  TransRate,  Throughput,  Concurrent,    OKAY,   Failed1 2016-07-31 08:35:21,      9,      29.86,           0,       0.83,        0.30,        0.00,        0.25,       9,       02 2016-07-31 08:36:39,     23,      29.60,           0,       1.06,        0.78,        0.00,        0.82,      23,      213 2016-07-31 08:40:15,    124,      29.99,           0,       2.34,        4.13,        0.00,        9.68,     124,       0</code></pre><p>This would give me a graph like below:</p><p><img src="https://raymii.org/s/inc/img/hsm/example.png" alt=""></p><p>But that doesn&#39;t scale very well for larger and smaller numbers and I didn&#39;tlike the overall look. So I looked around for simple online charting servicesand via Opensource.com found <a href="https://datawrapper.de">Datawrapper</a>. It&#39;s a nice service, lots ofoptions while keeping it simple. I shoved them $12 to export the images becauseI&#39;m to lazy to <a href="https://github.com/datawrapper/datawrapper">host it myself</a> or take screenshots. People put effort intohosting and development, so let&#39;s reward them for it.</p><h3>Benchmark process</h3><p>All the benchmarks were done three times and the best result is used. Themachine that runs haproxy wasn&#39;t doing anything else at the time, measured withnethogs. No spotify or skype skewing the benchmarks. All was done via a wiredgigabit network, cat6 cabling.</p><p>I&#39;ve also done benchmarks without the HSM, just regular apache with <code>mod_ssl</code>.Why not <code>mod_nss</code> you might ask? Well, because nobody will setup <code>mod_nss</code> whenthey can use <code>mod_ssl</code>. All the guides use <code>mod_ssl</code>.and the most sites onlineare using it. Only if you have special software or need PKCS#11 you need to usemod_nss.</p><h3>Benchmarks without the HSM</h3><p>The below benchmarks does not use the HSM, just regular <code>mod_ssl</code> and acertificate file. We&#39;re benchmarking one small page with only the contents &#39;Jeejit works!&#39;. We&#39;re also benchmarking a Wordpress 4.5.3 install with the defaultcontent after install and the Hemmingway theme.</p><p>I&#39;m not benchmarking multiple Pi&#39;s since the result of one Pi and the result ofthree Pi&#39;s was so comparable, I suspect they are fast enough and that <code>mod_ssl</code>doesn&#39;t have any bottlenecks there. Except for some tests, those just blew upthe Pi&#39;s. (8192 bit keys).</p><p>The HSM does not support 4096 or 8192 bit RSA keys, which is why I didnot testthose with the HSM&#39;s.</p><p>Here below are all the benchmarking results. Every benchmark was done threetimes, best result was kept.</p><h4>Benchmarking 1024 bit RSA key without HSM</h4><p>Self signed with OpenSSL:</p><pre><code>#key + certificateopenssl req -nodes -x509 -sha256 -newkey rsa:1024 -keyout &quot;pi1.hsmcluster.nl.key&quot; -out &quot;pi1.hsmcluster.nl.cert&quot; -days 365 -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;</code></pre><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     63 hitsAvailability:                 100.00 %Elapsed time:                  29.47 secsData transferred:               0.00 MBResponse time:                  0.04 secsTransaction rate:               2.14 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.08Successful transactions:          63Failed transactions:               0Longest transaction:            0.06Shortest transaction:           0.02</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    119 hitsAvailability:                 100.00 %Elapsed time:                  29.67 secsData transferred:               0.00 MBResponse time:                  0.04 secsTransaction rate:               4.01 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.16Successful transactions:         119Failed transactions:               0Longest transaction:            0.10Shortest transaction:           0.02</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    239 hitsAvailability:                 100.00 %Elapsed time:                  29.80 secsData transferred:               0.00 MBResponse time:                  0.04 secsTransaction rate:               8.02 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.30Successful transactions:         239Failed transactions:               0Longest transaction:            0.13Shortest transaction:           0.02</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                   7331 hitsAvailability:                 100.00 %Elapsed time:                  29.18 secsData transferred:               0.09 MBResponse time:                  0.23 secsTransaction rate:             251.23 trans/secThroughput:                     0.00 MB/secConcurrency:                   56.54Successful transactions:        7331Failed transactions:               0Longest transaction:            1.47Shortest transaction:           0.03</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    772 hitsAvailability:                 100.00 %Elapsed time:                  29.84 secsData transferred:               5.63 MBResponse time:                  0.06 secsTransaction rate:              25.87 trans/secThroughput:                     0.19 MB/secConcurrency:                    1.67Successful transactions:         772Failed transactions:               0Longest transaction:            0.75Shortest transaction:           0.02</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                   1353 hitsAvailability:                 100.00 %Elapsed time:                  29.09 secsData transferred:               9.87 MBResponse time:                  0.09 secsTransaction rate:              46.51 trans/secThroughput:                     0.34 MB/secConcurrency:                    4.23Successful transactions:        1353Failed transactions:               0Longest transaction:            2.46Shortest transaction:           0.02</code></pre><h4>Benchmarking 2048 bit RSA key without HSM</h4><p>Self signed with OpenSSL:</p><pre><code>#key + certificateopenssl req -nodes -x509 -sha256 -newkey rsa:2048 -keyout &quot;pi1.hsmcluster.nl.key&quot; -out &quot;pi1.hsmcluster.nl.cert&quot; -days 365 -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;</code></pre><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     51 hitsAvailability:                 100.00 %Elapsed time:                  29.28 secsData transferred:               0.00 MBResponse time:                  0.06 secsTransaction rate:               1.74 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.10Successful transactions:          51Failed transactions:               0Longest transaction:            0.10Shortest transaction:           0.04</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    126 hitsAvailability:                 100.00 %Elapsed time:                  29.68 secsData transferred:               0.00 MBResponse time:                  0.07 secsTransaction rate:               4.25 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.28Successful transactions:         126Failed transactions:               0Longest transaction:            0.19Shortest transaction:           0.04</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Lifting the server siege...Transactions:                    253 hitsAvailability:                 100.00 %Elapsed time:                  29.57 secsData transferred:               0.00 MBResponse time:                  0.07 secsTransaction rate:               8.56 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.60Successful transactions:         253Failed transactions:               0Longest transaction:            0.28Shortest transaction:           0.04</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                   2999 hitsAvailability:                 100.00 %Elapsed time:                  29.92 secsData transferred:               0.04 MBResponse time:                  0.58 secsTransaction rate:             100.23 trans/secThroughput:                     0.00 MB/secConcurrency:                   58.55Successful transactions:        2999Failed transactions:               0Longest transaction:            1.87Shortest transaction:           0.14</code></pre><p>60 benchmark mode with 3 Pi&#39;s in haproxy:</p><pre><code>Transactions:                   4890 hitsAvailability:                 100.00 %Elapsed time:                  29.80 secsData transferred:               0.06 MBResponse time:                  0.36 secsTransaction rate:             164.09 trans/secThroughput:                     0.00 MB/secConcurrency:                   58.74Successful transactions:        4890Failed transactions:               0Longest transaction:            1.42Shortest transaction:           0.04</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    707 hitsAvailability:                 100.00 %Elapsed time:                  29.66 secsData transferred:               5.16 MBResponse time:                  0.10 secsTransaction rate:              23.84 trans/secThroughput:                     0.17 MB/secConcurrency:                    2.29Successful transactions:         707Failed transactions:               0Longest transaction:            1.86Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                   1267 hitsAvailability:                 100.00 %Elapsed time:                  29.62 secsData transferred:               9.25 MBResponse time:                  0.12 secsTransaction rate:              42.78 trans/secThroughput:                     0.31 MB/secConcurrency:                    5.26Successful transactions:        1267Failed transactions:               0Longest transaction:            2.55Shortest transaction:           0.04</code></pre><h4>Benchmarking 4096 bit RSA key without HSM</h4><p>Self signed with OpenSSL:</p><pre><code>#key + certificateopenssl req -nodes -x509 -sha256 -newkey rsa:4096 -keyout &quot;pi1.hsmcluster.nl.key&quot; -out &quot;pi1.hsmcluster.nl.cert&quot; -days 365 -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;</code></pre><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     51 hitsAvailability:                 100.00 %Elapsed time:                  29.47 secsData transferred:               0.00 MBResponse time:                  0.22 secsTransaction rate:               1.73 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.38Successful transactions:          51Failed transactions:               0Longest transaction:            0.45Shortest transaction:           0.19</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    117 hitsAvailability:                 100.00 %Elapsed time:                  29.85 secsData transferred:               0.00 MBResponse time:                  0.29 secsTransaction rate:               3.92 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.14Successful transactions:         117Failed transactions:               0Longest transaction:            0.87Shortest transaction:           0.19  </code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    234 hitsAvailability:                 100.00 %Elapsed time:                  29.30 secsData transferred:               0.00 MBResponse time:                  0.29 secsTransaction rate:               7.99 trans/secThroughput:                     0.00 MB/secConcurrency:                    2.31Successful transactions:         234Failed transactions:               0Longest transaction:            1.14Shortest transaction:           0.19</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    591 hitsAvailability:                 100.00 %Elapsed time:                  29.94 secsData transferred:               0.01 MBResponse time:                  2.91 secsTransaction rate:              19.74 trans/secThroughput:                     0.00 MB/secConcurrency:                   57.35Successful transactions:         592Failed transactions:               0Longest transaction:            3.82Shortest transaction:           0.40</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    483 hitsAvailability:                 100.00 %Elapsed time:                  29.22 secsData transferred:               3.53 MBResponse time:                  0.27 secsTransaction rate:              16.53 trans/secThroughput:                     0.12 MB/secConcurrency:                    4.46Successful transactions:         483Failed transactions:               0Longest transaction:            1.98Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    577 hitsAvailability:                 100.00 %Elapsed time:                  29.69 secsData transferred:               4.08 MBResponse time:                  0.67 secsTransaction rate:              19.43 trans/secThroughput:                     0.14 MB/secConcurrency:                   13.10Successful transactions:         577Failed transactions:               0Longest transaction:            2.37Shortest transaction:           0.04</code></pre><h4>Benchmarking 8192 bit RSA key without HSM</h4><p>Self signed with OpenSSL:</p><pre><code>#key + certificateopenssl req -nodes -x509 -sha256 -newkey rsa:8192 -keyout &quot;pi1.hsmcluster.nl.key&quot; -out &quot;pi1.hsmcluster.nl.cert&quot; -days 365 -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;</code></pre><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     39 hitsAvailability:                 100.00 %Elapsed time:                  29.84 secsData transferred:               0.00 MBResponse time:                  1.36 secsTransaction rate:               1.31 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.77Successful transactions:          39Failed transactions:               0Longest transaction:            1.81Shortest transaction:           1.30</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     70 hitsAvailability:                 100.00 %Elapsed time:                  29.94 secsData transferred:               0.00 MBResponse time:                  1.81 secsTransaction rate:               2.34 trans/secThroughput:                     0.00 MB/secConcurrency:                    4.22Successful transactions:          70Failed transactions:               0Longest transaction:            3.38Shortest transaction:           1.30</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     71 hitsAvailability:                 100.00 %Elapsed time:                  29.25 secsData transferred:               0.00 MBResponse time:                  5.13 secsTransaction rate:               2.43 trans/secThroughput:                     0.00 MB/secConcurrency:                   12.44Successful transactions:          71Failed transactions:               0Longest transaction:            6.78Shortest transaction:           1.36</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>This benchmark was done against THREE Pi&#39;s, one or two would fail and give thePi a load of +100.</p><p>Result:</p><pre><code>Transactions:                    176 hitsAvailability:                 100.00 %Elapsed time:                  29.75 secsData transferred:               0.00 MBResponse time:                  5.44 secsTransaction rate:               5.92 trans/secThroughput:                     0.00 MB/secConcurrency:                   32.21Successful transactions:         176Failed transactions:               0Longest transaction:           22.08Shortest transaction:           1.30</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     40 hitsAvailability:                 100.00 %Elapsed time:                  29.05 secsData transferred:               0.08 MBResponse time:                  6.76 secsTransaction rate:               1.38 trans/secThroughput:                     0.00 MB/secConcurrency:                    9.31Successful transactions:          40Failed transactions:               0Longest transaction:            7.89Shortest transaction:           5.62</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     62 hitsAvailability:                 100.00 %Elapsed time:                  29.39 secsData transferred:               0.10 MBResponse time:                  7.28 secsTransaction rate:               2.11 trans/secThroughput:                     0.00 MB/secConcurrency:                   15.36Successful transactions:          62Failed transactions:               0Longest transaction:            8.41Shortest transaction:           5.33</code></pre><h4>Benchmarking prime256v1 (NIST curve P-256) EC key without HSM</h4><p>Self signed with OpenSSL:</p><pre><code>#keyopenssl ecparam -out ec_key.pem -name pi1.hsmcluster.nl.key -name prime256v1 -genkey#certificateopenssl req -new -key pi1.hsmcluster.nl.key -x509 -nodes -days 365 -out pi1.hsmcluster.nl.cert -subj &quot;/C=NL/ST=Zuid Holland/L=Rotterdam/O=Sparkling Network/OU=IT Dept/CN=pi1.hsmcluster.nl&quot;</code></pre><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     41 hitsAvailability:                 100.00 %Elapsed time:                  29.79 secsData transferred:               0.00 MBResponse time:                  1.37 secsTransaction rate:               1.38 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.89Successful transactions:          41Failed transactions:               0Longest transaction:            2.12Shortest transaction:           1.29</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     70 hitsAvailability:                 100.00 %Elapsed time:                  29.31 secsData transferred:               0.00 MBResponse time:                  1.72 secsTransaction rate:               2.39 trans/secThroughput:                     0.00 MB/secConcurrency:                    4.11Successful transactions:          70Failed transactions:               0Longest transaction:            3.46Shortest transaction:           1.29</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     76 hitsAvailability:                 100.00 %Elapsed time:                  29.35 secsData transferred:               0.00 MBResponse time:                  5.10 secsTransaction rate:               2.59 trans/secThroughput:                     0.00 MB/secConcurrency:                   13.21Successful transactions:          76Failed transactions:               0Longest transaction:            6.59Shortest transaction:           1.33</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>This benchmark was done against THREE Pi&#39;s, one or two would fail and give thePi a load of +100.</p><p>Result:</p><pre><code>Transactions:                     60 hitsAvailability:                 100.00 %Elapsed time:                  29.66 secsData transferred:               0.00 MBResponse time:                 23.60 secsTransaction rate:               2.02 trans/secThroughput:                     0.00 MB/secConcurrency:                   47.74Successful transactions:          60Failed transactions:               0Longest transaction:           26.21Shortest transaction:          20.71</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     86 hitsAvailability:                 100.00 %Elapsed time:                  29.18 secsData transferred:               0.55 MBResponse time:                  2.93 secsTransaction rate:               2.95 trans/secThroughput:                     0.02 MB/secConcurrency:                    8.63Successful transactions:          86Failed transactions:               0Longest transaction:            4.49Shortest transaction:           0.05</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     80 hitsAvailability:                 100.00 %Elapsed time:                  29.19 secsData transferred:               0.17 MBResponse time:                  6.75 secsTransaction rate:               2.74 trans/secThroughput:                     0.01 MB/secConcurrency:                   18.50Successful transactions:          80Failed transactions:               0Longest transaction:            8.17Shortest transaction:           6.10</code></pre><h3>OpenSC benchmarks</h3><p>The below benchmarks utilize the <code>opensc-pkcs11</code> module with <code>mod_nss</code>. We&#39;rebenchmarking one small page with only the contents &#39;Jeej it works!&#39;. We&#39;re alsobenchmarking a Wordpress 4.5.3 install with the default content after installand the Hemmingway theme.</p><p>Note to self, the below command formats the <code>siege</code> output directly to space-seperated (instead of tab) markdown code output:</p><pre><code>siege  -c10 -d5 -t30S &#39;https://hsmcluster.nl/&#39; 2&gt;&amp;1 | grep -v &#39;==&gt; GET &#39; | expand | sed &#39;s/^/    /&#39;</code></pre><h4>1 HSM (OpenSC)</h4><h5>Benchmarking 1024 bit RSA key with 1 HSM (OpenSC)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     52 hitsAvailability:                 100.00 %Elapsed time:                  29.52 secsData transferred:               0.00 MBResponse time:                  0.33 secsTransaction rate:               1.76 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.57Successful transactions:          52Failed transactions:               0Longest transaction:            1.06Shortest transaction:           0.22</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    101 hitsAvailability:                 100.00 %Elapsed time:                  29.07 secsData transferred:               0.00 MBResponse time:                  0.52 secsTransaction rate:               3.47 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.80Successful transactions:         101Failed transactions:               0Longest transaction:            2.06Shortest transaction:           0.22</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    142 hitsAvailability:                 100.00 %Elapsed time:                  29.86 secsData transferred:               0.00 MBResponse time:                  1.78 secsTransaction rate:               4.76 trans/secThroughput:                     0.00 MB/secConcurrency:                    8.47Successful transactions:         142Failed transactions:               0Longest transaction:            5.07Shortest transaction:           0.23</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    126 hitsAvailability:                 100.00 %Elapsed time:                  29.37 secsData transferred:               0.00 MBResponse time:                  8.96 secsTransaction rate:               4.29 trans/secThroughput:                     0.00 MB/secConcurrency:                   38.46Successful transactions:         126Failed transactions:               0Longest transaction:           19.99Shortest transaction:           0.60</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    162 hitsAvailability:                 100.00 %Elapsed time:                  29.13 secsData transferred:               1.14 MBResponse time:                  1.50 secsTransaction rate:               5.56 trans/secThroughput:                     0.04 MB/secConcurrency:                    8.35Successful transactions:         162Failed transactions:               0Longest transaction:            8.85Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    165 hitsAvailability:                 100.00 %Elapsed time:                  29.77 secsData transferred:               1.07 MBResponse time:                  3.08 secsTransaction rate:               5.54 trans/secThroughput:                     0.04 MB/secConcurrency:                   17.06Successful transactions:         165Failed transactions:               0Longest transaction:           10.86Shortest transaction:           0.05</code></pre><h5>Benchmarking 2048 bit RSA key with 1 HSM (OpenSC)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     35 hitsAvailability:                 100.00 %Elapsed time:                  29.01 secsData transferred:               0.00 MBResponse time:                  1.23 secsTransaction rate:               1.21 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.49Successful transactions:          35Failed transactions:               0Longest transaction:            3.48Shortest transaction:           0.66</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     45 hitsAvailability:                 100.00 %Elapsed time:                  29.92 secsData transferred:               0.00 MBResponse time:                  3.79 secsTransaction rate:               1.50 trans/secThroughput:                     0.00 MB/secConcurrency:                    5.70Successful transactions:          45Failed transactions:               0Longest transaction:           17.70Shortest transaction:           0.68</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     44 hitsAvailability:                 100.00 %Elapsed time:                  29.15 secsData transferred:               0.00 MBResponse time:                  8.83 secsTransaction rate:               1.51 trans/secThroughput:                     0.00 MB/secConcurrency:                   13.32Successful transactions:          44Failed transactions:               0Longest transaction:           27.20Shortest transaction:           0.69</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     42 hitsAvailability:                 100.00 %Elapsed time:                  29.35 secsData transferred:               0.00 MBResponse time:                 12.53 secsTransaction rate:               1.43 trans/secThroughput:                     0.00 MB/secConcurrency:                   17.94Successful transactions:          42Failed transactions:               0Longest transaction:           28.97Shortest transaction:           0.00</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     49 hitsAvailability:                 100.00 %Elapsed time:                  29.24 secsData transferred:               0.24 MBResponse time:                  4.40 secsTransaction rate:               1.68 trans/secThroughput:                     0.01 MB/secConcurrency:                    7.37Successful transactions:          49Failed transactions:               0Longest transaction:           24.25Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     46 hitsAvailability:                 100.00 %Elapsed time:                  29.98 secsData transferred:               0.13 MBResponse time:                  9.63 secsTransaction rate:               1.53 trans/secThroughput:                     0.00 MB/secConcurrency:                   14.77Successful transactions:          46Failed transactions:               0Longest transaction:           29.81Shortest transaction:           0.05</code></pre><h5>Benchmarking EC prime256v1 key with 1 HSM (OpenSC)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     52 hitsAvailability:                 100.00 %Elapsed time:                  29.95 secsData transferred:               0.00 MBResponse time:                  0.48 secsTransaction rate:               1.74 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.84Successful transactions:          52Failed transactions:               0Longest transaction:            1.91Shortest transaction:           0.27</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     92 hitsAvailability:                 100.00 %Elapsed time:                  29.49 secsData transferred:               0.00 MBResponse time:                  1.01 secsTransaction rate:               3.12 trans/secThroughput:                     0.00 MB/secConcurrency:                    3.16Successful transactions:          92Failed transactions:               0Longest transaction:            4.65Shortest transaction:           0.27</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    103 hitsAvailability:                 100.00 %Elapsed time:                  29.96 secsData transferred:               0.00 MBResponse time:                  3.35 secsTransaction rate:               3.44 trans/secThroughput:                     0.00 MB/secConcurrency:                   11.53Successful transactions:         103Failed transactions:               0Longest transaction:            8.37Shortest transaction:           0.28</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     97 hitsAvailability:                 100.00 %Elapsed time:                  29.90 secsData transferred:               0.00 MBResponse time:                 10.76 secsTransaction rate:               3.24 trans/secThroughput:                     0.00 MB/secConcurrency:                   34.89Successful transactions:          97Failed transactions:               0Longest transaction:           29.19Shortest transaction:           0.00</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    120 hitsAvailability:                 100.00 %Elapsed time:                  29.84 secsData transferred:               0.80 MBResponse time:                  2.11 secsTransaction rate:               4.02 trans/secThroughput:                     0.03 MB/secConcurrency:                    8.49Successful transactions:         120Failed transactions:               0Longest transaction:            8.04Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    116 hitsAvailability:                 100.00 %Elapsed time:                  29.87 secsData transferred:               0.59 MBResponse time:                  4.25 secsTransaction rate:               3.88 trans/secThroughput:                     0.02 MB/secConcurrency:                   16.52Successful transactions:         116Failed transactions:               0Longest transaction:           14.15Shortest transaction:           0.05</code></pre><h4>2 HSM&#39;s (OpenSC)</h4><h5>Benchmarking 1024 bit RSA key with 2 HSM&#39;s (OpenSC)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     51 hitsAvailability:                 100.00 %Elapsed time:                  29.17 secsData transferred:               0.00 MBResponse time:                  0.28 secsTransaction rate:               1.75 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.49Successful transactions:          51Failed transactions:               0Longest transaction:            1.06Shortest transaction:           0.22</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    107 hitsAvailability:                 100.00 %Elapsed time:                  29.23 secsData transferred:               0.00 MBResponse time:                  0.30 secsTransaction rate:               3.66 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.09Successful transactions:         107Failed transactions:               0Longest transaction:            1.31Shortest transaction:           0.22</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    217 hitsAvailability:                 100.00 %Elapsed time:                  29.96 secsData transferred:               0.00 MBResponse time:                  0.58 secsTransaction rate:               7.24 trans/secThroughput:                     0.00 MB/secConcurrency:                    4.21Successful transactions:         217Failed transactions:               0Longest transaction:            4.26Shortest transaction:           0.22</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    277 hitsAvailability:                 100.00 %Elapsed time:                  29.72 secsData transferred:               0.00 MBResponse time:                  5.66 secsTransaction rate:               9.32 trans/secThroughput:                     0.00 MB/secConcurrency:                   52.77Successful transactions:         277Failed transactions:               0Longest transaction:           18.27Shortest transaction:           0.47</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    286 hitsAvailability:                 100.00 %Elapsed time:                  29.76 secsData transferred:               2.04 MBResponse time:                  0.78 secsTransaction rate:               9.61 trans/secThroughput:                     0.07 MB/secConcurrency:                    7.45Successful transactions:         286Failed transactions:               0Longest transaction:            4.67Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    298 hitsAvailability:                 100.00 %Elapsed time:                  29.12 secsData transferred:               2.04 MBResponse time:                  1.51 secsTransaction rate:              10.23 trans/secThroughput:                     0.07 MB/secConcurrency:                   15.49Successful transactions:         298Failed transactions:               0Longest transaction:            9.48Shortest transaction:           0.04</code></pre><h5>Benchmarking 2048 bit RSA key with 2 HSM&#39;s (OpenSC)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     47 hitsAvailability:                 100.00 %Elapsed time:                  29.00 secsData transferred:               0.00 MBResponse time:                  1.01 secsTransaction rate:               1.62 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.63Successful transactions:          47Failed transactions:               0Longest transaction:            3.08Shortest transaction:           0.66</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     75 hitsAvailability:                 100.00 %Elapsed time:                  29.05 secsData transferred:               0.00 MBResponse time:                  1.58 secsTransaction rate:               2.58 trans/secThroughput:                     0.00 MB/secConcurrency:                    4.07Successful transactions:          75Failed transactions:               0Longest transaction:            7.71Shortest transaction:           0.66</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     82 hitsAvailability:                 100.00 %Elapsed time:                  29.74 secsData transferred:               0.00 MBResponse time:                  4.25 secsTransaction rate:               2.76 trans/secThroughput:                     0.00 MB/secConcurrency:                   11.72Successful transactions:          82Failed transactions:               0Longest transaction:           17.67Shortest transaction:           0.67</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     46 hitsAvailability:                 100.00 %Elapsed time:                  29.11 secsData transferred:               0.00 MBResponse time:                 15.96 secsTransaction rate:               1.58 trans/secThroughput:                     0.00 MB/secConcurrency:                   25.22Successful transactions:          46Failed transactions:               0Longest transaction:           28.88Shortest transaction:           2.22</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     92 hitsAvailability:                 100.00 %Elapsed time:                  29.44 secsData transferred:               0.61 MBResponse time:                  2.61 secsTransaction rate:               3.12 trans/secThroughput:                     0.02 MB/secConcurrency:                    8.16Successful transactions:          92Failed transactions:               0Longest transaction:           13.43Shortest transaction:           0.05</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     75 hitsAvailability:                 100.00 %Elapsed time:                  29.60 secsData transferred:               0.41 MBResponse time:                  5.35 secsTransaction rate:               2.53 trans/secThroughput:                     0.01 MB/secConcurrency:                   13.56Successful transactions:          75Failed transactions:               0Longest transaction:           21.47Shortest transaction:           0.00</code></pre><h5>Benchmarking EC prime256v1 key with 2 HSM&#39;s (OpenSC)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     60 hitsAvailability:                 100.00 %Elapsed time:                  29.30 secsData transferred:               0.00 MBResponse time:                  0.31 secsTransaction rate:               2.05 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.64Successful transactions:          60Failed transactions:               0Longest transaction:            1.09Shortest transaction:           0.26</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    106 hitsAvailability:                 100.00 %Elapsed time:                  29.71 secsData transferred:               0.00 MBResponse time:                  0.42 secsTransaction rate:               3.57 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.50Successful transactions:         106Failed transactions:               0Longest transaction:            1.58Shortest transaction:           0.26</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    184 hitsAvailability:                 100.00 %Elapsed time:                  29.61 secsData transferred:               0.00 MBResponse time:                  0.80 secsTransaction rate:               6.21 trans/secThroughput:                     0.00 MB/secConcurrency:                    4.99Successful transactions:         184Failed transactions:               0Longest transaction:            4.12Shortest transaction:           0.26  </code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    201 hitsAvailability:                 100.00 %Elapsed time:                  29.50 secsData transferred:               0.00 MBResponse time:                  5.56 secsTransaction rate:               6.81 trans/secThroughput:                     0.00 MB/secConcurrency:                   37.90Successful transactions:         201Failed transactions:               0Longest transaction:           27.49Shortest transaction:           0.26</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    237 hitsAvailability:                 100.00 %Elapsed time:                  29.56 secsData transferred:               1.69 MBResponse time:                  0.90 secsTransaction rate:               8.02 trans/secThroughput:                     0.06 MB/secConcurrency:                    7.25Successful transactions:         237Failed transactions:               0Longest transaction:            4.72Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    240 hitsAvailability:                 100.00 %Elapsed time:                  29.28 secsData transferred:               1.67 MBResponse time:                  2.08 secsTransaction rate:               8.20 trans/secThroughput:                     0.06 MB/secConcurrency:                   17.03Successful transactions:         240Failed transactions:               0Longest transaction:            7.64Shortest transaction:           0.04</code></pre><h4>3 HSM&#39;s (OpenSC)</h4><h5>Benchmarking 1024 bit RSA key with 3 HSM&#39;s (OpenSC)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     54 hitsAvailability:                 100.00 %Elapsed time:                  29.88 secsData transferred:               0.00 MBResponse time:                  0.25 secsTransaction rate:               1.81 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.46Successful transactions:          54Failed transactions:               0Longest transaction:            0.66Shortest transaction:           0.22</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    118 hitsAvailability:                 100.00 %Elapsed time:                  29.72 secsData transferred:               0.00 MBResponse time:                  0.28 secsTransaction rate:               3.97 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.12Successful transactions:         118Failed transactions:               0Longest transaction:            1.66Shortest transaction:           0.22 </code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    205 hitsAvailability:                 100.00 %Elapsed time:                  29.85 secsData transferred:               0.00 MBResponse time:                  0.32 secsTransaction rate:               6.87 trans/secThroughput:                     0.00 MB/secConcurrency:                    2.19Successful transactions:         206Failed transactions:               0Longest transaction:            1.69Shortest transaction:           0.22</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    407 hitsAvailability:                 100.00 %Elapsed time:                  29.07 secsData transferred:               0.01 MBResponse time:                  3.65 secsTransaction rate:              14.00 trans/secThroughput:                     0.00 MB/secConcurrency:                   51.11Successful transactions:         407Failed transactions:               0Longest transaction:           17.38Shortest transaction:           0.25</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    382 hitsAvailability:                 100.00 %Elapsed time:                  29.48 secsData transferred:               2.73 MBResponse time:                  0.40 secsTransaction rate:              12.96 trans/secThroughput:                     0.09 MB/secConcurrency:                    5.22Successful transactions:         382Failed transactions:               0Longest transaction:            1.99Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    449 hitsAvailability:                 100.00 %Elapsed time:                  29.31 secsData transferred:               3.18 MBResponse time:                  0.99 secsTransaction rate:              15.32 trans/secThroughput:                     0.11 MB/secConcurrency:                   15.12Successful transactions:         449Failed transactions:               0Longest transaction:            6.49Shortest transaction:           0.04</code></pre><h5>Benchmarking 2048 bit RSA key with 3 HSM&#39;s (OpenSC)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     44 hitsAvailability:                 100.00 %Elapsed time:                  29.10 secsData transferred:               0.00 MBResponse time:                  0.75 secsTransaction rate:               1.51 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.13Successful transactions:          44Failed transactions:               0Longest transaction:            1.50Shortest transaction:           0.66</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     89 hitsAvailability:                 100.00 %Elapsed time:                  29.34 secsData transferred:               0.00 MBResponse time:                  0.90 secsTransaction rate:               3.03 trans/secThroughput:                     0.00 MB/secConcurrency:                    2.72Successful transactions:          89Failed transactions:               0Longest transaction:            2.67Shortest transaction:           0.66</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    127 hitsAvailability:                 100.00 %Elapsed time:                  29.99 secsData transferred:               0.00 MBResponse time:                  2.05 secsTransaction rate:               4.23 trans/secThroughput:                     0.00 MB/secConcurrency:                    8.69Successful transactions:         127Failed transactions:               0Longest transaction:           11.20Shortest transaction:           0.66</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    128 hitsAvailability:                 100.00 %Elapsed time:                  29.53 secsData transferred:               0.00 MBResponse time:                  9.24 secsTransaction rate:               4.33 trans/secThroughput:                     0.00 MB/secConcurrency:                   40.07Successful transactions:         128Failed transactions:               0Longest transaction:           23.46Shortest transaction:           0.66</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    139 hitsAvailability:                 100.00 %Elapsed time:                  29.43 secsData transferred:               0.97 MBResponse time:                  1.79 secsTransaction rate:               4.72 trans/secThroughput:                     0.03 MB/secConcurrency:                    8.48Successful transactions:         139Failed transactions:               0Longest transaction:           11.38Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    140 hitsAvailability:                 100.00 %Elapsed time:                  29.39 secsData transferred:               0.89 MBResponse time:                  3.58 secsTransaction rate:               4.76 trans/secThroughput:                     0.03 MB/secConcurrency:                   17.04Successful transactions:         140Failed transactions:               0Longest transaction:           21.96Shortest transaction:           0.05</code></pre><h5>Benchmarking EC prime256v1 key with 3 HSM&#39;s (OpenSC)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     51 hitsAvailability:                 100.00 %Elapsed time:                  29.73 secsData transferred:               0.00 MBResponse time:                  0.31 secsTransaction rate:               1.72 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.53Successful transactions:          51Failed transactions:               0Longest transaction:            0.67Shortest transaction:           0.25    </code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    110 hitsAvailability:                 100.00 %Elapsed time:                  29.41 secsData transferred:               0.00 MBResponse time:                  0.34 secsTransaction rate:               3.74 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.26Successful transactions:         110Failed transactions:               0Longest transaction:            1.29Shortest transaction:           0.25</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    221 hitsAvailability:                 100.00 %Elapsed time:                  29.82 secsData transferred:               0.00 MBResponse time:                  0.44 secsTransaction rate:               7.41 trans/secThroughput:                     0.00 MB/secConcurrency:                    3.24Successful transactions:         221Failed transactions:               0Longest transaction:            2.12Shortest transaction:           0.24</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    331 hitsAvailability:                 100.00 %Elapsed time:                  29.64 secsData transferred:               0.00 MBResponse time:                  4.29 secsTransaction rate:              11.17 trans/secThroughput:                     0.00 MB/secConcurrency:                   47.90Successful transactions:         331Failed transactions:               0Longest transaction:           25.01Shortest transaction:           0.25</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    336 hitsAvailability:                 100.00 %Elapsed time:                  29.48 secsData transferred:               2.42 MBResponse time:                  0.54 secsTransaction rate:              11.40 trans/secThroughput:                     0.08 MB/secConcurrency:                    6.10Successful transactions:         336Failed transactions:               0Longest transaction:            2.70Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    377 hitsAvailability:                 100.00 %Elapsed time:                  29.86 secsData transferred:               2.59 MBResponse time:                  1.21 secsTransaction rate:              12.63 trans/secThroughput:                     0.09 MB/secConcurrency:                   15.27Successful transactions:         377Failed transactions:               0Longest transaction:            5.02Shortest transaction:           0.04</code></pre><h3>sc-hsm-embedded benchmarks</h3><p>The below benchmarks utilize the read only <code>libsc-hsm-embedded</code> module with<code>mod_nss</code>. Read more on the <a href="https://raymii.org/s/articles/Use_the_Nitrokey_HSM_or_SmartCard-HSM_with_sc-hsm-embedded_mod_nss_and_Apache_read_only_module.html">sc-hsm-embedded</a> module here.</p><p>This module is targeted at embedded use in devices, but can also be usedregularly. I recommend it over the OpenSC module, since in production you don&#39;twant to be able to write to the HSM. You should have a seperate, non-networkedworkstation for that.</p><h4>1 HSM (sc-hsm-embedded)</h4><h5>Benchmarking 1024 bit RSA key with 1 HSM (sc-hsm-embedded)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     56 hitsAvailability:                 100.00 %Elapsed time:                  29.48 secsData transferred:               0.00 MBResponse time:                  0.31 secsTransaction rate:               1.90 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.60Successful transactions:          56Failed transactions:               0Longest transaction:            1.13Shortest transaction:           0.24</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    100 hitsAvailability:                 100.00 %Elapsed time:                  29.18 secsData transferred:               0.00 MBResponse time:                  0.52 secsTransaction rate:               3.43 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.78Successful transactions:         100Failed transactions:               0Longest transaction:            2.24Shortest transaction:           0.24</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    131 hitsAvailability:                 100.00 %Elapsed time:                  29.17 secsData transferred:               0.00 MBResponse time:                  2.04 secsTransaction rate:               4.49 trans/secThroughput:                     0.00 MB/secConcurrency:                    9.17Successful transactions:         131Failed transactions:               0Longest transaction:            6.56Shortest transaction:           0.28</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    124 hitsAvailability:                 100.00 %Elapsed time:                  29.50 secsData transferred:               0.00 MBResponse time:                 10.24 secsTransaction rate:               4.20 trans/secThroughput:                     0.00 MB/secConcurrency:                   43.03Successful transactions:         124Failed transactions:               0Longest transaction:           19.99Shortest transaction:           0.94</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    148 hitsAvailability:                 100.00 %Elapsed time:                  29.63 secsData transferred:               1.02 MBResponse time:                  1.68 secsTransaction rate:               4.99 trans/secThroughput:                     0.03 MB/secConcurrency:                    8.39Successful transactions:         148Failed transactions:               0Longest transaction:            5.48Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    144 hitsAvailability:                 100.00 %Elapsed time:                  29.12 secsData transferred:               0.98 MBResponse time:                  3.63 secsTransaction rate:               4.95 trans/secThroughput:                     0.03 MB/secConcurrency:                   17.94Successful transactions:         144Failed transactions:               0Longest transaction:           11.69Shortest transaction:           0.04</code></pre><h5>Benchmarking 2048 bit RSA key with 1 HSM (sc-hsm-embedded)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     36 hitsAvailability:                 100.00 %Elapsed time:                  29.78 secsData transferred:               0.00 MBResponse time:                  1.59 secsTransaction rate:               1.21 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.93Successful transactions:          36Failed transactions:               0Longest transaction:            3.89Shortest transaction:           0.67</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     44 hitsAvailability:                 100.00 %Elapsed time:                  29.19 secsData transferred:               0.00 MBResponse time:                  4.21 secsTransaction rate:               1.51 trans/secThroughput:                     0.00 MB/secConcurrency:                    6.34Successful transactions:          44Failed transactions:               0Longest transaction:            9.43Shortest transaction:           0.68</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     39 hitsAvailability:                 100.00 %Elapsed time:                  29.06 secsData transferred:               0.00 MBResponse time:                  9.92 secsTransaction rate:               1.34 trans/secThroughput:                     0.00 MB/secConcurrency:                   13.32Successful transactions:          39Failed transactions:               0Longest transaction:           16.25Shortest transaction:           1.60</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     23 hitsAvailability:                 100.00 %Elapsed time:                  29.82 secsData transferred:               0.00 MBResponse time:                 17.65 secsTransaction rate:               0.77 trans/secThroughput:                     0.00 MB/secConcurrency:                   13.61Successful transactions:          23Failed transactions:               0Longest transaction:           29.12Shortest transaction:           0.00</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     40 hitsAvailability:                 100.00 %Elapsed time:                  29.75 secsData transferred:               0.17 MBResponse time:                  6.87 secsTransaction rate:               1.34 trans/secThroughput:                     0.01 MB/secConcurrency:                    9.23Successful transactions:          40Failed transactions:               0Longest transaction:           16.12Shortest transaction:           1.66</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     33 hitsAvailability:                 100.00 %Elapsed time:                  29.01 secsData transferred:               0.07 MBResponse time:                 11.64 secsTransaction rate:               1.14 trans/secThroughput:                     0.00 MB/secConcurrency:                   13.24Successful transactions:          33Failed transactions:               0Longest transaction:           26.08Shortest transaction:           3.18</code></pre><h5>Benchmarking EC prime256v1 key with 1 HSM (sc-hsm-embedded)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     59 hitsAvailability:                 100.00 %Elapsed time:                  29.15 secsData transferred:               0.00 MBResponse time:                  0.37 secsTransaction rate:               2.02 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.75Successful transactions:          59Failed transactions:               0Longest transaction:            1.22Shortest transaction:           0.25</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    103 hitsAvailability:                 100.00 %Elapsed time:                  29.67 secsData transferred:               0.00 MBResponse time:                  0.57 secsTransaction rate:               3.47 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.98Successful transactions:         103Failed transactions:               0Longest transaction:            2.86Shortest transaction:           0.25</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    122 hitsAvailability:                 100.00 %Elapsed time:                  29.85 secsData transferred:               0.00 MBResponse time:                  2.10 secsTransaction rate:               4.09 trans/secThroughput:                     0.00 MB/secConcurrency:                    8.59Successful transactions:         122Failed transactions:               0Longest transaction:            6.55Shortest transaction:           0.30</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    109 hitsAvailability:                 100.00 %Elapsed time:                  29.45 secsData transferred:               0.00 MBResponse time:                 11.17 secsTransaction rate:               3.70 trans/secThroughput:                     0.00 MB/secConcurrency:                   41.33Successful transactions:         109Failed transactions:               0Longest transaction:           23.97Shortest transaction:           0.52</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    137 hitsAvailability:                 100.00 %Elapsed time:                  29.04 secsData transferred:               0.93 MBResponse time:                  1.68 secsTransaction rate:               4.72 trans/secThroughput:                     0.03 MB/secConcurrency:                    7.94Successful transactions:         137Failed transactions:               0Longest transaction:            4.49Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    138 hitsAvailability:                 100.00 %Elapsed time:                  29.64 secsData transferred:               0.95 MBResponse time:                  3.96 secsTransaction rate:               4.66 trans/secThroughput:                     0.03 MB/secConcurrency:                   18.44Successful transactions:         138Failed transactions:               0Longest transaction:           12.19Shortest transaction:           0.05</code></pre><h4>2 HSM&#39;s (sc-hsm-embedded)</h4><h5>Benchmarking 1024 bit RSA key with 2 HSM&#39;s (sc-hsm-embedded)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     59 hitsAvailability:                 100.00 %Elapsed time:                  29.34 secsData transferred:               0.00 MBResponse time:                  0.26 secsTransaction rate:               2.01 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.52Successful transactions:          59Failed transactions:               0Longest transaction:            0.62Shortest transaction:           0.22</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    109 hitsAvailability:                 100.00 %Elapsed time:                  29.04 secsData transferred:               0.00 MBResponse time:                  0.29 secsTransaction rate:               3.75 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.10Successful transactions:         109Failed transactions:               0Longest transaction:            1.13Shortest transaction:           0.22</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    211 hitsAvailability:                 100.00 %Elapsed time:                  29.36 secsData transferred:               0.00 MBResponse time:                  0.42 secsTransaction rate:               7.19 trans/secThroughput:                     0.00 MB/secConcurrency:                    3.01Successful transactions:         211Failed transactions:               0Longest transaction:            2.45Shortest transaction:           0.22</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    253 hitsAvailability:                 100.00 %Elapsed time:                  29.04 secsData transferred:               0.00 MBResponse time:                  5.24 secsTransaction rate:               8.71 trans/secThroughput:                     0.00 MB/secConcurrency:                   45.62Successful transactions:         253Failed transactions:               0Longest transaction:           18.60Shortest transaction:           0.25</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    308 hitsAvailability:                 100.00 %Elapsed time:                  29.22 secsData transferred:               2.20 MBResponse time:                  0.61 secsTransaction rate:              10.54 trans/secThroughput:                     0.08 MB/secConcurrency:                    6.39Successful transactions:         308Failed transactions:               0Longest transaction:            2.29Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    318 hitsAvailability:                 100.00 %Elapsed time:                  29.94 secsData transferred:               2.21 MBResponse time:                  1.53 secsTransaction rate:              10.62 trans/secThroughput:                     0.07 MB/secConcurrency:                   16.23Successful transactions:         318Failed transactions:               0Longest transaction:            7.03Shortest transaction:           0.04</code></pre><h5>Benchmarking 2048 bit RSA key with 2 HSM&#39;s (sc-hsm-embedded)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     47 hitsAvailability:                 100.00 %Elapsed time:                  29.86 secsData transferred:               0.00 MBResponse time:                  0.82 secsTransaction rate:               1.57 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.29Successful transactions:          47Failed transactions:               0Longest transaction:            1.93Shortest transaction:           0.66</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     74 hitsAvailability:                 100.00 %Elapsed time:                  29.90 secsData transferred:               0.00 MBResponse time:                  1.50 secsTransaction rate:               2.47 trans/secThroughput:                     0.00 MB/secConcurrency:                    3.71Successful transactions:          74Failed transactions:               0Longest transaction:            4.43Shortest transaction:           0.66</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     84 hitsAvailability:                 100.00 %Elapsed time:                  29.03 secsData transferred:               0.00 MBResponse time:                  4.29 secsTransaction rate:               2.89 trans/secThroughput:                     0.00 MB/secConcurrency:                   12.42Successful transactions:          84Failed transactions:               0Longest transaction:           14.70Shortest transaction:           0.69</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     72 hitsAvailability:                 100.00 %Elapsed time:                  29.87 secsData transferred:               0.00 MBResponse time:                 13.06 secsTransaction rate:               2.41 trans/secThroughput:                     0.00 MB/secConcurrency:                   31.48Successful transactions:          72Failed transactions:               0Longest transaction:           27.91Shortest transaction:           2.27</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     95 hitsAvailability:                 100.00 %Elapsed time:                  29.51 secsData transferred:               0.60 MBResponse time:                  2.75 secsTransaction rate:               3.22 trans/secThroughput:                     0.02 MB/secConcurrency:                    8.86Successful transactions:          95Failed transactions:               0Longest transaction:            8.09Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                     87 hitsAvailability:                 100.00 %Elapsed time:                  29.89 secsData transferred:               0.41 MBResponse time:                  6.08 secsTransaction rate:               2.91 trans/secThroughput:                     0.01 MB/secConcurrency:                   17.70Successful transactions:          87Failed transactions:               0Longest transaction:           17.31Shortest transaction:           0.05</code></pre><h5>Benchmarking EC prime256v1 key with 2 HSM&#39;s (sc-hsm-embedded)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     59 hitsAvailability:                 100.00 %Elapsed time:                  29.14 secsData transferred:               0.00 MBResponse time:                  0.29 secsTransaction rate:               2.02 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.59Successful transactions:          59Failed transactions:               0Longest transaction:            0.71Shortest transaction:           0.24</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     98 hitsAvailability:                 100.00 %Elapsed time:                  29.19 secsData transferred:               0.00 MBResponse time:                  0.34 secsTransaction rate:               3.36 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.13Successful transactions:          98Failed transactions:               0Longest transaction:            1.20Shortest transaction:           0.24</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    217 hitsAvailability:                 100.00 %Elapsed time:                  29.94 secsData transferred:               0.00 MBResponse time:                  0.52 secsTransaction rate:               7.25 trans/secThroughput:                     0.00 MB/secConcurrency:                    3.78Successful transactions:         217Failed transactions:               0Longest transaction:            2.39Shortest transaction:           0.24</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    232 hitsAvailability:                 100.00 %Elapsed time:                  29.22 secsData transferred:               0.00 MBResponse time:                  5.62 secsTransaction rate:               7.94 trans/secThroughput:                     0.00 MB/secConcurrency:                   44.64Successful transactions:         232Failed transactions:               0Longest transaction:           20.16Shortest transaction:           0.27</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    276 hitsAvailability:                 100.00 %Elapsed time:                  29.35 secsData transferred:               1.92 MBResponse time:                  0.72 secsTransaction rate:               9.40 trans/secThroughput:                     0.07 MB/secConcurrency:                    6.74Successful transactions:         276Failed transactions:               0Longest transaction:            2.42Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    288 hitsAvailability:                 100.00 %Elapsed time:                  29.86 secsData transferred:               1.94 MBResponse time:                  1.77 secsTransaction rate:               9.65 trans/secThroughput:                     0.06 MB/secConcurrency:                   17.08Successful transactions:         288Failed transactions:               0Longest transaction:            8.33Shortest transaction:           0.04</code></pre><h4>3 HSM&#39;s (sc-hsm-embedded)</h4><h5>Benchmarking 1024 bit RSA key with 3 HSM&#39;s (sc-hsm-embedded)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     55 hitsAvailability:                 100.00 %Elapsed time:                  29.81 secsData transferred:               0.00 MBResponse time:                  0.24 secsTransaction rate:               1.85 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.45Successful transactions:          55Failed transactions:               0Longest transaction:            0.47Shortest transaction:           0.22</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    116 hitsAvailability:                 100.00 %Elapsed time:                  29.33 secsData transferred:               0.00 MBResponse time:                  0.26 secsTransaction rate:               3.95 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.05Successful transactions:         116Failed transactions:               0Longest transaction:            0.81Shortest transaction:           0.22</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    227 hitsAvailability:                 100.00 %Elapsed time:                  29.82 secsData transferred:               0.00 MBResponse time:                  0.31 secsTransaction rate:               7.61 trans/secThroughput:                     0.00 MB/secConcurrency:                    2.39Successful transactions:         227Failed transactions:               0Longest transaction:            1.58Shortest transaction:           0.22</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    420 hitsAvailability:                 100.00 %Elapsed time:                  29.90 secsData transferred:               0.01 MBResponse time:                  3.79 secsTransaction rate:              14.05 trans/secThroughput:                     0.00 MB/secConcurrency:                   53.27Successful transactions:         420Failed transactions:               0Longest transaction:           20.31Shortest transaction:           0.27</code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    430 hitsAvailability:                 100.00 %Elapsed time:                  29.46 secsData transferred:               3.11 MBResponse time:                  0.37 secsTransaction rate:              14.60 trans/secThroughput:                     0.11 MB/secConcurrency:                    5.38Successful transactions:         430Failed transactions:               0Longest transaction:            1.96Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    494 hitsAvailability:                 100.00 %Elapsed time:                  29.72 secsData transferred:               3.49 MBResponse time:                  0.87 secsTransaction rate:              16.62 trans/secThroughput:                     0.12 MB/secConcurrency:                   14.43Successful transactions:         494Failed transactions:               0Longest transaction:            3.93Shortest transaction:           0.04</code></pre><h5>Benchmarking 2048 bit RSA key with 3 HSM&#39;s (sc-hsm-embedded)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     50 hitsAvailability:                 100.00 %Elapsed time:                  29.58 secsData transferred:               0.00 MBResponse time:                  0.73 secsTransaction rate:               1.69 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.23Successful transactions:          50Failed transactions:               0Longest transaction:            1.50Shortest transaction:           0.66</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     99 hitsAvailability:                 100.00 %Elapsed time:                  29.82 secsData transferred:               0.00 MBResponse time:                  0.91 secsTransaction rate:               3.32 trans/secThroughput:                     0.00 MB/secConcurrency:                    3.01Successful transactions:          99Failed transactions:               0Longest transaction:            2.97Shortest transaction:           0.66</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    126 hitsAvailability:                 100.00 %Elapsed time:                  29.85 secsData transferred:               0.00 MBResponse time:                  2.22 secsTransaction rate:               4.22 trans/secThroughput:                     0.00 MB/secConcurrency:                    9.35Successful transactions:         126Failed transactions:               0Longest transaction:            7.04Shortest transaction:           0.66     </code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    118 hitsAvailability:                 100.00 %Elapsed time:                  29.28 secsData transferred:               0.00 MBResponse time:                 10.28 secsTransaction rate:               4.03 trans/secThroughput:                     0.00 MB/secConcurrency:                   41.44Successful transactions:         118Failed transactions:               0Longest transaction:           29.13Shortest transaction:           0.66    </code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    141 hitsAvailability:                 100.00 %Elapsed time:                  29.05 secsData transferred:               1.00 MBResponse time:                  1.74 secsTransaction rate:               4.85 trans/secThroughput:                     0.03 MB/secConcurrency:                    8.44Successful transactions:         141Failed transactions:               0Longest transaction:            4.63Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    145 hitsAvailability:                 100.00 %Elapsed time:                  29.27 secsData transferred:               1.01 MBResponse time:                  3.57 secsTransaction rate:               4.95 trans/secThroughput:                     0.03 MB/secConcurrency:                   17.70Successful transactions:         145Failed transactions:               0Longest transaction:           12.44Shortest transaction:           0.04</code></pre><h5>Benchmarking EC prime256v1 key with 3 HSM&#39;s (sc-hsm-embedded)</h5><p>A siege test with 5 concurrent users, 30 seconds:</p><pre><code>siege -c5 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                     57 hitsAvailability:                 100.00 %Elapsed time:                  29.41 secsData transferred:               0.00 MBResponse time:                  0.29 secsTransaction rate:               1.94 trans/secThroughput:                     0.00 MB/secConcurrency:                    0.56Successful transactions:          57Failed transactions:               0Longest transaction:            0.56Shortest transaction:           0.24</code></pre><p>10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    104 hitsAvailability:                 100.00 %Elapsed time:                  29.02 secsData transferred:               0.00 MBResponse time:                  0.31 secsTransaction rate:               3.58 trans/secThroughput:                     0.00 MB/secConcurrency:                    1.11Successful transactions:         104Failed transactions:               0Longest transaction:            0.94Shortest transaction:           0.25</code></pre><p>20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    220 hitsAvailability:                 100.00 %Elapsed time:                  29.82 secsData transferred:               0.00 MBResponse time:                  0.40 secsTransaction rate:               7.38 trans/secThroughput:                     0.00 MB/secConcurrency:                    2.97Successful transactions:         220Failed transactions:               0Longest transaction:            2.16Shortest transaction:           0.25</code></pre><p>60 benchmark mode:</p><pre><code>siege -c60 -b -t30S https://hsmcluster.nl</code></pre><p>Result:</p><pre><code>Transactions:                    360 hitsAvailability:                 100.00 %Elapsed time:                  29.99 secsData transferred:               0.00 MBResponse time:                  4.34 secsTransaction rate:              12.00 trans/secThroughput:                     0.00 MB/secConcurrency:                   52.12Successful transactions:         360Failed transactions:               0Longest transaction:           18.87Shortest transaction:           0.30    </code></pre><p>Wordpress site with 10 concurrent users:</p><pre><code>siege -c10 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    382 hitsAvailability:                 100.00 %Elapsed time:                  29.57 secsData transferred:               2.77 MBResponse time:                  0.45 secsTransaction rate:              12.92 trans/secThroughput:                     0.09 MB/secConcurrency:                    5.86Successful transactions:         382Failed transactions:               0Longest transaction:            2.32Shortest transaction:           0.04</code></pre><p>Wordpress site with 20 concurrent users:</p><pre><code>siege -c20 -d5 -t30S &#39;https://hsmcluster.nl/wordpress/&#39;</code></pre><p>Result:</p><pre><code>Transactions:                    427 hitsAvailability:                 100.00 %Elapsed time:                  29.96 secsData transferred:               2.90 MBResponse time:                  1.11 secsTransaction rate:              14.25 trans/secThroughput:                     0.10 MB/secConcurrency:                   15.83Successful transactions:         427Failed transactions:               0Longest transaction:            3.71Shortest transaction:           0.04</code></pre>Tags: <a href="../tags/apache.html">apache</a>, <a href="../tags/articles.html">articles</a>, <a href="../tags/cluster.html">cluster</a>, <a href="../tags/cryptoki.html">cryptoki</a>, <a href="../tags/haproxy.html">haproxy</a>, <a href="../tags/hsm.html">hsm</a>, <a href="../tags/mod_nss.html">mod_nss</a>, <a href="../tags/nginx.html">nginx</a>, <a href="../tags/nitrokey.html">nitrokey</a>, <a href="../tags/nitrokey-hsm.html">nitrokey-hsm</a>, <a href="../tags/openssl.html">openssl</a>, <a href="../tags/pkcs11.html">pkcs11</a>, <a href="../tags/safenet.html">safenet</a>, <a href="../tags/smartcard.html">smartcard</a>, <a href="../tags/smartcard-hsm.html">smartcard-hsm</a></div><br/><footer><br/><form role="search" action="https://encrypted.google.com/search"                style="min-width:250px;max-width:300px;"><div class="form-group"><input type="hidden" name="as_sitesearch" value="raymii.org"><input type="hidden" name="as_qdr" value="all"><input type="text" name="as_q" class="form-control" placeholder="Search"></div></form><br><p><small><a href="/s/">Home</a> |                 <a href="/s/static/About.html">About</a> |                 <a href="/s/tags/all.html">All pages</a> |                 <a href="/s/software/Sparkling_Network.html">Cluster Status</a> |                 Generated by <a href="/s/software/ingsoc.html">ingsoc</a>.</small></p></footer><script async src="https://www.googletagmanager.com/gtag/js?id=UA-3704876-6"></script><script>      window.dataLayer = window.dataLayer || [];      function gtag(){dataLayer.push(arguments);}      gtag('js', new Date());      gtag('config', 'UA-3704876-6');    </script></main></body></html>    